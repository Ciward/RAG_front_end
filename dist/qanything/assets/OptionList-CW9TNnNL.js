import{l as v,a0 as It,a1 as me,a2 as $t,a3 as Ot,a4 as Xe,a5 as Dt,a6 as vt,a7 as He,k as ce,q as L,j as pe,d as m,A as ee,L as ge,a8 as Pt,i as Lt,m as Ft,a9 as Nt,aa as Tt,u as Et,ab as Mt,ac as Rt,ad as Ut,ae as zt,I as mt,Y as ke,J as j,v as Ce,K as le,x as Bt,af as Wt,o as $,C as H,_ as we,F as a,e as _,D,w as T,N as te,$ as jt,c as K,U as ht,R as Vt,W as Ke,g as Y,ag as yt,ah as Qt,G as bt,H as _t,y as kt,S as Ct,ai as qe,M as at,n as qt}from"./index-BgCptZ8v.js";import{u as ae,g as Zt,r as ne,f as Ht,c as nt,d as Kt,b as Yt,a as Xt}from"./utils-CgHaWdtE.js";import{g as de}from"./index-C3b_4KEV.js";import{i as Ge}from"./initDefaultProps-DXmK0m_U.js";import{C as Gt}from"./index-T6_lEB_G.js";import{d as Jt,_ as Ue,B as Je}from"./index-BeP7JuK_.js";import{a as wt,L as es}from"./ChatInfoPanel-Dq_K_9z0.js";import{a as ts,_ as ss,M as et}from"./HighLightMarkDown.vue_vue_type_style_index_0_lang-CnhL4iYQ.js";import{S as os}from"./index-CYKBjq0_.js";import{_ as At,a as as}from"./index-BoPW_fsp.js";import{_ as ns}from"./ActionButton-DerkmszR.js";const ls=()=>{const e=v(new Map),t=s=>o=>{e.value.set(s,o)};return It(()=>{e.value=new Map}),[t,e]},rs=["normal","exception","active","success"],ze=()=>({prefixCls:String,type:me(),percent:Number,format:$t(),status:me(),showInfo:Ot(),strokeWidth:Number,strokeLinecap:me(),strokeColor:Xe(),trailColor:String,width:Number,success:Dt(),gapDegree:Number,gapPosition:me(),size:vt([String,Number,Array]),steps:Number,successPercent:Number,title:String,progressStatus:me()});function fe(e){return!e||e<0?0:e>100?100:e}function Me(e){let{success:t,successPercent:s}=e,o=s;return t&&"progress"in t&&(Jt(!1,"Progress","`success.progress` is deprecated. Please use `success.percent` instead."),o=t.progress),t&&"percent"in t&&(o=t.percent),o}function is(e){let{percent:t,success:s,successPercent:o}=e;const n=fe(Me({success:s,successPercent:o}));return[n,fe(fe(t)-n)]}function cs(e){let{success:t={},strokeColor:s}=e;const{strokeColor:o}=t;return[o||He.green,s||null]}const Be=(e,t,s)=>{var o,n,b,r;let i=-1,c=-1;if(t==="step"){const w=s.steps,u=s.strokeWidth;typeof e=="string"||typeof e>"u"?(i=e==="small"?2:14,c=u??8):typeof e=="number"?[i,c]=[e,e]:[i=14,c=8]=e,i*=w}else if(t==="line"){const w=s==null?void 0:s.strokeWidth;typeof e=="string"||typeof e>"u"?c=w||(e==="small"?6:8):typeof e=="number"?[i,c]=[e,e]:[i=-1,c=8]=e}else(t==="circle"||t==="dashboard")&&(typeof e=="string"||typeof e>"u"?[i,c]=e==="small"?[60,60]:[120,120]:typeof e=="number"?[i,c]=[e,e]:(i=(n=(o=e[0])!==null&&o!==void 0?o:e[1])!==null&&n!==void 0?n:120,c=(r=(b=e[0])!==null&&b!==void 0?b:e[1])!==null&&r!==void 0?r:120));return{width:i,height:c}};var us=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(s[o[n]]=e[o[n]]);return s};const ds=()=>pe(pe({},ze()),{strokeColor:Xe(),direction:me()}),ps=e=>{let t=[];return Object.keys(e).forEach(s=>{const o=parseFloat(s.replace(/%/g,""));isNaN(o)||t.push({key:o,value:e[s]})}),t=t.sort((s,o)=>s.key-o.key),t.map(s=>{let{key:o,value:n}=s;return`${n} ${o}%`}).join(", ")},gs=(e,t)=>{const{from:s=He.blue,to:o=He.blue,direction:n=t==="rtl"?"to left":"to right"}=e,b=us(e,["from","to","direction"]);if(Object.keys(b).length!==0){const r=ps(b);return{backgroundImage:`linear-gradient(${n}, ${r})`}}return{backgroundImage:`linear-gradient(${n}, ${s}, ${o})`}},fs=ce({compatConfig:{MODE:3},name:"ProgressLine",inheritAttrs:!1,props:ds(),setup(e,t){let{slots:s,attrs:o}=t;const n=L(()=>{const{strokeColor:d,direction:p}=e;return d&&typeof d!="string"?gs(d,p):{backgroundColor:d}}),b=L(()=>e.strokeLinecap==="square"||e.strokeLinecap==="butt"?0:void 0),r=L(()=>e.trailColor?{backgroundColor:e.trailColor}:void 0),i=L(()=>{var d;return(d=e.size)!==null&&d!==void 0?d:[-1,e.strokeWidth||(e.size==="small"?6:8)]}),c=L(()=>Be(i.value,"line",{strokeWidth:e.strokeWidth})),w=L(()=>{const{percent:d}=e;return pe({width:`${fe(d)}%`,height:`${c.value.height}px`,borderRadius:b.value},n.value)}),u=L(()=>Me(e)),x=L(()=>{const{success:d}=e;return{width:`${fe(u.value)}%`,height:`${c.value.height}px`,borderRadius:b.value,backgroundColor:d==null?void 0:d.strokeColor}}),y={width:c.value.width<0?"100%":c.value.width,height:`${c.value.height}px`};return()=>{var d;return m(ge,null,[m("div",ee(ee({},o),{},{class:[`${e.prefixCls}-outer`,o.class],style:[o.style,y]}),[m("div",{class:`${e.prefixCls}-inner`,style:r.value},[m("div",{class:`${e.prefixCls}-bg`,style:w.value},null),u.value!==void 0?m("div",{class:`${e.prefixCls}-success-bg`,style:x.value},null):null])]),(d=s.default)===null||d===void 0?void 0:d.call(s)])}}}),vs={percent:0,prefixCls:"vc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1},ms=e=>{const t=v(null);return Pt(()=>{const s=Date.now();let o=!1;e.value.forEach(n=>{const b=(n==null?void 0:n.$el)||n;if(!b)return;o=!0;const r=b.style;r.transitionDuration=".3s, .3s, .3s, .06s",t.value&&s-t.value<100&&(r.transitionDuration="0s, 0s")}),o&&(t.value=Date.now())}),e},hs={gapDegree:Number,gapPosition:{type:String},percent:{type:[Array,Number]},prefixCls:String,strokeColor:{type:[Object,String,Array]},strokeLinecap:{type:String},strokeWidth:Number,trailColor:String,trailWidth:Number,transition:String};var ys=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(s[o[n]]=e[o[n]]);return s};let lt=0;function rt(e){return+e.replace("%","")}function it(e){return Array.isArray(e)?e:[e]}function ct(e,t,s,o){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,b=arguments.length>5?arguments[5]:void 0;const r=50-o/2;let i=0,c=-r,w=0,u=-2*r;switch(b){case"left":i=-r,c=0,w=2*r,u=0;break;case"right":i=r,c=0,w=-2*r,u=0;break;case"bottom":c=r,u=2*r;break}const x=`M 50,50 m ${i},${c}
   a ${r},${r} 0 1 1 ${w},${-u}
   a ${r},${r} 0 1 1 ${-w},${u}`,y=Math.PI*2*r,d={stroke:s,strokeDasharray:`${t/100*(y-n)}px ${y}px`,strokeDashoffset:`-${n/2+e/100*(y-n)}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s"};return{pathString:x,pathStyle:d}}const bs=ce({compatConfig:{MODE:3},name:"VCCircle",props:Ge(hs,vs),setup(e){lt+=1;const t=v(lt),s=L(()=>it(e.percent)),o=L(()=>it(e.strokeColor)),[n,b]=ls();ms(b);const r=()=>{const{prefixCls:i,strokeWidth:c,strokeLinecap:w,gapDegree:u,gapPosition:x}=e;let y=0;return s.value.map((d,p)=>{const g=o.value[p]||o.value[o.value.length-1],F=Object.prototype.toString.call(g)==="[object Object]"?`url(#${i}-gradient-${t.value})`:"",{pathString:E,pathStyle:U}=ct(y,d,g,c,u,x);y+=d;const R={key:p,d:E,stroke:F,"stroke-linecap":w,"stroke-width":c,opacity:d===0?0:1,"fill-opacity":"0",class:`${i}-circle-path`,style:U};return m("path",ee({ref:n(p)},R),null)})};return()=>{const{prefixCls:i,strokeWidth:c,trailWidth:w,gapDegree:u,gapPosition:x,trailColor:y,strokeLinecap:d,strokeColor:p}=e,g=ys(e,["prefixCls","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","strokeColor"]),{pathString:F,pathStyle:E}=ct(0,100,y,c,u,x);delete g.percent;const U=o.value.find(M=>Object.prototype.toString.call(M)==="[object Object]"),R={d:F,stroke:y,"stroke-linecap":d,"stroke-width":w||c,"fill-opacity":"0",class:`${i}-circle-trail`,style:E};return m("svg",ee({class:`${i}-circle`,viewBox:"0 0 100 100"},g),[U&&m("defs",null,[m("linearGradient",{id:`${i}-gradient-${t.value}`,x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[Object.keys(U).sort((M,V)=>rt(M)-rt(V)).map((M,V)=>m("stop",{key:V,offset:M,"stop-color":U[M]},null))])]),m("path",R,null),r().reverse()])}}}),_s=()=>pe(pe({},ze()),{strokeColor:Xe()}),ks=3,Cs=e=>ks/e*100,ws=ce({compatConfig:{MODE:3},name:"ProgressCircle",inheritAttrs:!1,props:Ge(_s(),{trailColor:null}),setup(e,t){let{slots:s,attrs:o}=t;const n=L(()=>{var g;return(g=e.width)!==null&&g!==void 0?g:120}),b=L(()=>{var g;return(g=e.size)!==null&&g!==void 0?g:[n.value,n.value]}),r=L(()=>Be(b.value,"circle")),i=L(()=>{if(e.gapDegree||e.gapDegree===0)return e.gapDegree;if(e.type==="dashboard")return 75}),c=L(()=>({width:`${r.value.width}px`,height:`${r.value.height}px`,fontSize:`${r.value.width*.15+6}px`})),w=L(()=>{var g;return(g=e.strokeWidth)!==null&&g!==void 0?g:Math.max(Cs(r.value.width),6)}),u=L(()=>e.gapPosition||e.type==="dashboard"&&"bottom"||void 0),x=L(()=>is(e)),y=L(()=>Object.prototype.toString.call(e.strokeColor)==="[object Object]"),d=L(()=>cs({success:e.success,strokeColor:e.strokeColor})),p=L(()=>({[`${e.prefixCls}-inner`]:!0,[`${e.prefixCls}-circle-gradient`]:y.value}));return()=>{var g;const F=m(bs,{percent:x.value,strokeWidth:w.value,trailWidth:w.value,strokeColor:d.value,strokeLinecap:e.strokeLinecap,trailColor:e.trailColor,prefixCls:e.prefixCls,gapDegree:i.value,gapPosition:u.value},null);return m("div",ee(ee({},o),{},{class:[p.value,o.class],style:[o.style,c.value]}),[r.value.width<=20?m(Ue,null,{default:()=>[m("span",null,[F])],title:s.default}):m(ge,null,[F,(g=s.default)===null||g===void 0?void 0:g.call(s)])])}}}),As=()=>pe(pe({},ze()),{steps:Number,strokeColor:vt(),trailColor:String}),Ss=ce({compatConfig:{MODE:3},name:"Steps",props:As(),setup(e,t){let{slots:s}=t;const o=L(()=>Math.round(e.steps*((e.percent||0)/100))),n=L(()=>{var i;return(i=e.size)!==null&&i!==void 0?i:[e.size==="small"?2:14,e.strokeWidth||8]}),b=L(()=>Be(n.value,"step",{steps:e.steps,strokeWidth:e.strokeWidth||8})),r=L(()=>{const{steps:i,strokeColor:c,trailColor:w,prefixCls:u}=e,x=[];for(let y=0;y<i;y+=1){const d=Array.isArray(c)?c[y]:c,p={[`${u}-steps-item`]:!0,[`${u}-steps-item-active`]:y<=o.value-1};x.push(m("div",{key:y,class:p,style:{backgroundColor:y<=o.value-1?d:w,width:`${b.value.width/i}px`,height:`${b.value.height}px`}},null))}return x});return()=>{var i;return m("div",{class:`${e.prefixCls}-steps-outer`},[r.value,(i=s.default)===null||i===void 0?void 0:i.call(s)])}}}),xs=new Tt("antProgressActive",{"0%":{transform:"translateX(-100%) scaleX(0)",opacity:.1},"20%":{transform:"translateX(-100%) scaleX(0)",opacity:.5},to:{transform:"translateX(0) scaleX(1)",opacity:0}}),Is=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:pe(pe({},Nt(e)),{display:"inline-block","&-rtl":{direction:"rtl"},"&-line":{position:"relative",width:"100%",fontSize:e.fontSize,marginInlineEnd:e.marginXS,marginBottom:e.marginXS},[`${t}-outer`]:{display:"inline-block",width:"100%"},[`&${t}-show-info`]:{[`${t}-outer`]:{marginInlineEnd:`calc(-2em - ${e.marginXS}px)`,paddingInlineEnd:`calc(2em + ${e.paddingXS}px)`}},[`${t}-inner`]:{position:"relative",display:"inline-block",width:"100%",overflow:"hidden",verticalAlign:"middle",backgroundColor:e.progressRemainingColor,borderRadius:e.progressLineRadius},[`${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorInfo}},[`${t}-success-bg, ${t}-bg`]:{position:"relative",backgroundColor:e.colorInfo,borderRadius:e.progressLineRadius,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`},[`${t}-success-bg`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,backgroundColor:e.colorSuccess},[`${t}-text`]:{display:"inline-block",width:"2em",marginInlineStart:e.marginXS,color:e.progressInfoTextColor,lineHeight:1,whiteSpace:"nowrap",textAlign:"start",verticalAlign:"middle",wordBreak:"normal",[s]:{fontSize:e.fontSize}},[`&${t}-status-active`]:{[`${t}-bg::before`]:{position:"absolute",inset:0,backgroundColor:e.colorBgContainer,borderRadius:e.progressLineRadius,opacity:0,animationName:xs,animationDuration:e.progressActiveMotionDuration,animationTimingFunction:e.motionEaseOutQuint,animationIterationCount:"infinite",content:'""'}},[`&${t}-status-exception`]:{[`${t}-bg`]:{backgroundColor:e.colorError},[`${t}-text`]:{color:e.colorError}},[`&${t}-status-exception ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorError}},[`&${t}-status-success`]:{[`${t}-bg`]:{backgroundColor:e.colorSuccess},[`${t}-text`]:{color:e.colorSuccess}},[`&${t}-status-success ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorSuccess}}})}},$s=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:{[`${t}-circle-trail`]:{stroke:e.progressRemainingColor},[`&${t}-circle ${t}-inner`]:{position:"relative",lineHeight:1,backgroundColor:"transparent"},[`&${t}-circle ${t}-text`]:{position:"absolute",insetBlockStart:"50%",insetInlineStart:0,width:"100%",margin:0,padding:0,color:e.colorText,lineHeight:1,whiteSpace:"normal",textAlign:"center",transform:"translateY(-50%)",[s]:{fontSize:`${e.fontSize/e.fontSizeSM}em`}},[`${t}-circle&-status-exception`]:{[`${t}-text`]:{color:e.colorError}},[`${t}-circle&-status-success`]:{[`${t}-text`]:{color:e.colorSuccess}}},[`${t}-inline-circle`]:{lineHeight:1,[`${t}-inner`]:{verticalAlign:"bottom"}}}},Os=e=>{const{componentCls:t}=e;return{[t]:{[`${t}-steps`]:{display:"inline-block","&-outer":{display:"flex",flexDirection:"row",alignItems:"center"},"&-item":{flexShrink:0,minWidth:e.progressStepMinWidth,marginInlineEnd:e.progressStepMarginInlineEnd,backgroundColor:e.progressRemainingColor,transition:`all ${e.motionDurationSlow}`,"&-active":{backgroundColor:e.colorInfo}}}}}},Ds=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:{[`${t}-small&-line, ${t}-small&-line ${t}-text ${s}`]:{fontSize:e.fontSizeSM}}}},Ps=Lt("Progress",e=>{const t=e.marginXXS/2,s=Ft(e,{progressLineRadius:100,progressInfoTextColor:e.colorText,progressDefaultColor:e.colorInfo,progressRemainingColor:e.colorFillSecondary,progressStepMarginInlineEnd:t,progressStepMinWidth:t,progressActiveMotionDuration:"2.4s"});return[Is(s),$s(s),Os(s),Ds(s)]});var Ls=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(s[o[n]]=e[o[n]]);return s};const Fs=ce({compatConfig:{MODE:3},name:"AProgress",inheritAttrs:!1,props:Ge(ze(),{type:"line",percent:0,showInfo:!0,trailColor:null,size:"default",strokeLinecap:"round"}),slots:Object,setup(e,t){let{slots:s,attrs:o}=t;const{prefixCls:n,direction:b}=Et("progress",e),[r,i]=Ps(n),c=L(()=>Array.isArray(e.strokeColor)?e.strokeColor[0]:e.strokeColor),w=L(()=>{const{percent:p=0}=e,g=Me(e);return parseInt(g!==void 0?g.toString():p.toString(),10)}),u=L(()=>{const{status:p}=e;return!rs.includes(p)&&w.value>=100?"success":p||"normal"}),x=L(()=>{const{type:p,showInfo:g,size:F}=e,E=n.value;return{[E]:!0,[`${E}-inline-circle`]:p==="circle"&&Be(F,"circle").width<=20,[`${E}-${p==="dashboard"&&"circle"||p}`]:!0,[`${E}-status-${u.value}`]:!0,[`${E}-show-info`]:g,[`${E}-${F}`]:F,[`${E}-rtl`]:b.value==="rtl",[i.value]:!0}}),y=L(()=>typeof e.strokeColor=="string"||Array.isArray(e.strokeColor)?e.strokeColor:void 0),d=()=>{const{showInfo:p,format:g,type:F,percent:E,title:U}=e,R=Me(e);if(!p)return null;let M;const V=g||(s==null?void 0:s.format)||(X=>`${X}%`),z=F==="line";return g||s!=null&&s.format||u.value!=="exception"&&u.value!=="success"?M=V(fe(E),fe(R)):u.value==="exception"?M=z?m(Mt,null,null):m(Rt,null,null):u.value==="success"&&(M=z?m(Ut,null,null):m(Gt,null,null)),m("span",{class:`${n.value}-text`,title:U===void 0&&typeof M=="string"?M:void 0},[M])};return()=>{const{type:p,steps:g,title:F}=e,{class:E}=o,U=Ls(o,["class"]),R=d();let M;return p==="line"?M=g?m(Ss,ee(ee({},e),{},{strokeColor:y.value,prefixCls:n.value,steps:g}),{default:()=>[R]}):m(fs,ee(ee({},e),{},{strokeColor:c.value,prefixCls:n.value,direction:b.value}),{default:()=>[R]}):(p==="circle"||p==="dashboard")&&(M=m(ws,ee(ee({},e),{},{prefixCls:n.value,strokeColor:c.value,progressStatus:u.value}),{default:()=>[R]})),r(m("div",ee(ee({role:"progressbar"},U),{},{class:[x.value,E],title:F}),[M]))}}}),Ns=zt(Fs);var Ts={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};function ut(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?Object(arguments[t]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable}))),o.forEach(function(n){Es(e,n,s[n])})}return e}function Es(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var tt=function(t,s){var o=ut({},t,s.attrs);return m(mt,ut({},o,{icon:Ts}),null)};tt.displayName="MinusCircleOutlined";tt.inheritAttrs=!1;var Ms={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};function dt(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?Object(arguments[t]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable}))),o.forEach(function(n){Rs(e,n,s[n])})}return e}function Rs(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var st=function(t,s){var o=dt({},t,s.attrs);return m(mt,dt({},o,{icon:Ms}),null)};st.displayName="PlusCircleOutlined";st.inheritAttrs=!1;var he=(e=>(e[e.initing=0]="initing",e[e.default=1]="default",e[e.normal=2]="normal",e[e.optionlist=3]="optionlist",e))(he||{});const pt=de().home,Us=de().common,Ye=ke("knowledgeModal",()=>{const e=v(!1),t=p=>{e.value=p},s=v(!1),o=p=>{s.value=p},n=v(pt.upload),b=p=>{n.value=p},r=v(""),i=p=>{r.value=p},c=v([]),w=p=>{c.value=p},u=v([]);return{modalVisible:e,setModalVisible:t,urlModalVisible:s,setUrlModalVisible:o,knowledgeName:r,setKnowledgeName:i,fileList:c,setFileList:w,urlList:u,setUrlList:p=>{u.value=p},modalTitle:n,setModalTitle:b,$reset:()=>{e.value=!1,n.value=pt.upload,r.value="",c.value=[],u.value=[]},getFileList:async p=>{try{const g=await ae.fileList({kb_id:p});g.code==200&&(g.data.details.forEach(F=>{F.errorText=Zt(F)}),w(g.data.details))}catch(g){console.log(g),j.error(g.msg||Us.error)}}}}),zs=de().common,_e=ke("knowledgeBase",()=>{const e=v(""),t=d=>{e.value=d};Ce(()=>e.value,()=>{console.log("current",e.value)});const s=v([]),o=d=>{s.value=d},n=v(""),b=d=>{n.value=d},r=v([]),i=d=>{r.value=d},c=v(he.initing),w=d=>{c.value=d},u=v(!1);return{currentId:e,setCurrentId:t,knowledgeBaseList:r,setKnowledgeBaseList:i,showDeleteModal:u,setShowDeleteModal:d=>{u.value=d},showDefault:c,setDefault:w,getList:async()=>{var d,p;try{const g=await ae.kbList();if(+g.code==200)if(((d=g==null?void 0:g.data)==null?void 0:d.length)>0){const F=g.data.filter(E=>!/.*_FAQ$/.test(E.kb_name));i(F),w(he.normal),s.value.length||s.value.push((p=F[0])==null?void 0:p.kb_id)}else i([]),w(he.default);console.log(r.value)}catch(g){j.error(g.msg||zs.error)}},currentKbName:n,setCurrentKbName:b,selectList:s,setSelectList:o}},{persist:{storage:localStorage}}),ga="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAIhSURBVFiF7dkxj6JAFMDx98ZLtMHYGRIKr7Tbzo7O0mQTSr6D+xE29wl273tQbE9hbbed5ZlAhqFDDIkm8N41q3cr6+0OcGI2+y/NjPMLGcEMCCdFUTQionsAuEHEkRBicDqmyYgoYeYEEZ8Q8adpmuuzg6WUD0opzrKMi6LgS5XnOWdZxkopllI+nMMtkiS5GOpcaZqylHJRunJpmrZtO5YkyfFKYhRFI0T8NRwOm9tYDRTHMTDzd8HMd4ZhtO0pZRgGENG9YObbbrfbtqdUr9cDALgRiDjodDpte0oJIeDlNvd/73N1EkIMRNuI9/oC1u3zAcMwhDRNtReqOk8buFqtYDabQRiGH54ThiG4rgvL5VJ3OQCllPaz0vM8tm2bgyB4d2wQBGzbNnuep72OUoorAZk/hqyDqw1k/jeyLq4RIPPbyCZwjQGZXyObwh2A3/R/VuUcxwEAANd1AQBgPp8fP6tbI0CAP8h+vw/T6bSprwVUSvG1/Zs+FMfxJ3zUXTrtPej7Pvi+X2kxx3FgMplozdEGjsfjSg/9w1zdtIGWZYFlWdoLVe3q9+AXsG7XDySipG3EuYgoEcy8JqK2LaWKogBmTgQAPO92u7Y9pfb7PSDi0/Ufv5mmuSaix81m07bp2Ha7BSJ6fHVeLaVcXMMp68vp6uJN+d+H6HmeXwxVFMXZQ3Q8RUZRNGLmO2a+RcTBhV5DrAHgWQjx4/Q1xG82m1G/NnWY4wAAAABJRU5ErkJggg==",Bs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAKFSURBVFiF1ZjNattAEIC/VH0Ag3O3wb0b+gKF0HMCfoAW/AAFP0ALaZ8guffQvoFzzsF5hNwLUu4F+Q2mB+1Yk9XfriTXycAiWdbufDuz2p2ZMxFJeMHy5tQAXfJ2YP8J8AGYufuZe/4E7N31wd3/N8AJ8Am4Apbud5dsgTvgV6yys8g1+AX4ZqD2wKNrajEoLbqksLBKBvyIAhWRJKC9F5FUStmJyEpEpgF9p+7dnemfisgiRHcI4FpEcgN2ETipprF0orkDHwR4bWZ9MwDMbzdm3Ou+gCszyGZEuLrJr2MBF1K6tXWGA9vG6cilWOfBgKnrOKZbu9ydhgKu2zoEtoWzTshXnkj5hVeWUh2gWq9xXQTA6Riha/fCvZ/7k/IB1Xq7EeDSCAs2WtEPFi7d9Tb8cDnIHLh31wz4SNwZrDqv7EN71E2Av+7+PHLwOrgsor/q/+Pu36l+a0E9M2OjjzHgoDzXNULCB9RQ6fEEcCqq+xAhWUAboZwCzupWY9Va8Ikw+cm4cFZ3LWCszLpfGS4WsELfIWq1OaWrh0rFixZQ/R8SwsNz184ZB7LyHdRZcBkxYMa4kKr7YEF/o65slIFi4TL6b9SVg8J3cWWjDBQLZWFjRHVuaXCx/glF9hYrGcMgVefds6deRDGVMpLumxz1CbcaY9C6eFDD8L4hl040JmDVCVVi0FcZ8idSJDDq6mNkdNo0s8ulIZFvSzt1XYgcJ7PbmPEbE/hXnbhrW0np7lT6J1OJFDuD5h55yFihxaOFjF88qk3U/RZbfvsMfPU24Afay2+2hrgHvhORlMUCWtBLvAysQfQI3QK/iay29gVUaSsBaxl4UAl4KODR5cVX+f8BBZDb8KKHVtYAAAAASUVORK5CYII=",Ws="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAP5JREFUOE+tlNENgzAMRM1khY28QcsG3qgwWauz4ujiJKBKzRcY5+U421nkT2uZcVR1FZEnfT/xbGav0Z4ONADsIgIo1qM87xnYgFQVp0FFlxgqZjkVRAmbmR3YSDG8Ax5xKHyLSM1l0IeV0C/CGwCwsSothzzMbMOhDsrBEouNrK4xW1VrDoNy0hq/QmDkuIIcCxDI56y0I8UF5C0COIOqmdwn4RUrSRV0nxjUyB4l50YsSt2SAFWJk+SD/UoeuSVc/kufJgfAH2cwqGsyqkxTiOJb01e3I1I2oRV8WG9HZDBLaESf+NLZfBN0Fb66RuK6wMTHGrZI41E289f3L/XxvhPPyll2AAAAAElFTkSuQmCC",St=ke("useChunkView",()=>({showChunkModel:v(!1)})),{currentId:Ze}=le(_e()),Re=ke("option-list",()=>{const e=v([]),t=l=>{e.value=l},s=v({green:0,gray:0,yellow:0,red:0}),o=v(0),n=l=>{o.value=l},b=v(1),r=l=>{b.value=l},i=v(10),c=v([]),w=l=>{c.value=l},u=v(0),x=l=>{u.value=l},y=v(1),d=l=>{y.value=l},p=v(10),g=v(!1),F=l=>{g.value=l},E=v("upload"),U=l=>{E.value=l},R=v(null),M=l=>{R.value=l},V=v(!1),z=l=>{V.value=l},X=v(null),se=async()=>{X.value&&clearTimeout(X.value);const l=await ne(await ae.fileList({kb_id:Ze.value,page_id:b.value,page_limit:i.value}));Object.keys(s.value).forEach(C=>{s.value[C]=0}),Object.assign(s.value,l.status_count),t([]),n(l.total);const Q=(C="",G="green")=>G!=="green"?C:JSON.parse(C.toString());l==null||l.details.forEach((C,G)=>{e.value.push({id:1e4+G,fileId:C==null?void 0:C.file_id,fileIdName:C==null?void 0:C.file_name,status:C==null?void 0:C.status,bytes:Ht((C==null?void 0:C.bytes)||0),contentLength:C==null?void 0:C.content_length,createtime:nt(C==null?void 0:C.timestamp),remark:(C==null?void 0:C.status)==="gray"?"":Q(C==null?void 0:C.msg,C==null?void 0:C.status)})}),(l==null?void 0:l.details.some(C=>C.status==="gray"||C.status==="yellow"))?X.value=setTimeout(()=>{clearTimeout(X.value),se()},5e3):N()},N=()=>{let l=null;l=setInterval(async()=>{const Q=await ne(await ae.fileList({kb_id:Ze.value,page_id:1,page_limit:i.value}));Object.keys(s.value).forEach(k=>{s.value[k]=0}),Object.assign(s.value,Q.status_count),n(Q.total),s.value.gray===0&&s.value.yellow===0&&clearInterval(l)},5e3)},h=v(null),P=async()=>{try{h.value&&clearTimeout(h.value),F(!0);const l=await ne(await ae.fileList({kb_id:Ze.value+"_FAQ",page_id:y.value,page_limit:p.value}));if(w([]),l!=null&&l.details)x(l.total);else{x(0),F(!1);return}for(const k of l==null?void 0:l.details){const C=l==null?void 0:l.details.indexOf(k);c.value.push({id:1e4+C,faqId:k==null?void 0:k.file_id,question:k==null?void 0:k.question,answer:k==null?void 0:k.answer,status:k==null?void 0:k.status,bytes:`${k==null?void 0:k.content_length}字符`,createtime:nt(k==null?void 0:k.timestamp),picUrlList:[]}),k!=null&&k.picUrlList&&await I(k==null?void 0:k.picUrlList).then(G=>{console.log("成功获取图片文件:",G),c.value[C].picUrlList=k==null?void 0:k.picUrlList.map((oe,ue)=>({uid:-ue,name:"image",status:"done",url:oe,originFileObj:G[ue]}))}).catch(G=>{console.error("获取图片文件出错:",G)})}(l==null?void 0:l.details.some(k=>k.status==="gray"||k.status==="yellow"))?(console.log("有解析中的  5s后再次请求"),h.value=setTimeout(()=>{clearTimeout(h.value),P()},5e3)):console.log("全部解析完成")}catch(l){console.log(l),j.error(l.msg||"获取faq列表失败")}F(!1)};function I(l){const Q=l.map(k=>new Promise((C,G)=>{fetch(k).then(oe=>oe.blob()).then(oe=>{const ue=k.substring(k.lastIndexOf("/")+1),ye=new File([oe],ue,{type:oe.type});C(ye)}).catch(oe=>{console.error("Error fetching the image:",oe),G(oe)})}));return Promise.all(Q)}return{dataSource:e,setDataSource:t,faqList:c,setFaqList:w,getDetails:se,timer:X,editQaSet:R,setEditQaSet:M,editModalVisible:V,setEditModalVisible:z,faqTimer:h,getFaqList:P,faqType:E,setFaqType:U,total:u,pageSize:p,setTotal:x,pageNum:y,setPageNum:d,loading:g,setLoading:F,totalStatus:s,kbTotal:o,kbPageSize:i,kbPageNum:b,setKbPageNum:r}},{persist:{storage:sessionStorage}}),js="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAATYSURBVFiFxZdtiFRVGMd/z3nu7KyO7vrCqMmuiIaKVFRWWmBqWRZSRmGfegGDCKkotBffmdQICvogfTECUYqISrLUMI1VUowQDEEiLCQXV3ZzdVd3ZmfmnvP0YWbWXdZdd3XDP9wv9577/H/3uef8z71iZspNlLuZ5gDRYAYvyHB7IeZe75mJUG+B0YapIJeBJuc4maji8KENHBtoTbnWK2gAWbeOhUUfnjJzExEUUDHUBEVQAlHlvBkqYk1RJDteXMI3L88iXDfAE5uZ0NzB68AUyoZiJVMzIhEUs8gQRSzqgjJRMBXhzxHDZeWBtZweNMCCDHdl87xikBJDxeGs/KRiaBAiKb3CCMoQWCQmXaBW6ko2obxzeCMHBgwwdz13Fj3LCVSZ4CrFBDzCb5Hwa20tp5Y8xHmAr38g3REzIxgPe88jIqTMUAE1cCIEVV47spGfrgnwaIbx7fmwGtxwo2xOUCccTY91X+xawYW+2gmw+EPS5y+wwowlZWhnoEDHqOE8uW8tf/cJ0NCArNrHuwaTDFz5ZqfKl1ej709zVvOCwfqyuaNU7+RLz/B494nZIwc2HOSBABNN8CJ4E3wiweeDNQc4+j7bVdmEoaXD1OCObd/yfPdxPQDyeeYDXgxvhlfj6C8Zfh6seUVHNrJNhO/AFMQBGhuvXhVgYYapwGgxPOCBXF2anddrXtG4FJtBiohFGApMnbuOub0AOmNmUG67GT5yHP/qTdpuFOD7NZwTxx7KyxNDC4HHegGYUSeGFwleHLEm+P1GzStSx+5KflBKyzm9AAKMMsGDizH8hBoahwqgNuI4VgktFJjWC8AgCcQYHke88EEuDRXAspmctbK5gWKkK9eu7IYBL4ILgjmDabOwoQJYuhR/YQrVANMu9azb1QFxXMaInQUPxJ9+wMihAmhoQP44RNR0Aj14muhEjq7w696B8yYkMWcCdjbPeKB9KABaWnCNSbQx20J1Nm1tqcYAdUC3DiQSNIrgXTkFCwWmDoU5QEMLVcUCEZfSGpJo9+ndBZBy/GXlBDQL3sPk57aQulHzrcdwZ3JUSw6lCr3YgdbW1fleAHs3cEYdrSZ4nIudIKf/ZfaNAuw/1D7SByIS6OVOtBbYsJTeAAAaccwJ3gLBAj4UmTJvPTOv1/zZrYxoy9akOgtotoBKoUM1otB9TA+A9+Zx0hzNInhxpViOjXsWZpg+aPOPqW1tYmwhRl2xdCRJhe0r6ewTYP58rH40+zE6zQjO4YMn5ArcPS/D7Ld2lNZyf9qyl2jR5tzElnbGFWNUwcWCYxgsuK/33nLVT7JFm5jUnvPzEDUHway0OgIUkgnO1AzjbO0ttC2rJw+wq4XEqX9IZS9Tk/eMdBBM8ZHifT4fElHST0/T/MlycgMCAFi8mbqLee4Pwasz9VZeomZ4jNhc7JUoBmJTYoQ48vjgi56qRKwQQoxPko/rRybPffY22av59PlntHsNjePG8KOatop4E8GCYSIYeHDRlUgNSOSRoIhpQhRc8EiUpHDbmJbGvsz77UBFDQ1I5iCT83F8K0i1GV5FfQixj6IotlCarBrwweFN8VWeXPUwmvesorW/2gMC6K6nP2LsxRzpUKQmFqodOAv4IORV6UhBe3UtF3e+MfCddFAA/4du+t/xf3hVSVyjFiskAAAAAElFTkSuQmCC",Vs=ce({__name:"LoadingImg",setup(e){const t=v(),s=()=>{t.value&&t.value.classList.add("loading")},o=()=>{t.value&&t.value.classList.remove("loading")};return Bt(()=>{s()}),Wt(()=>{o()}),(n,b)=>($(),H("img",{ref_key:"loadingRef",ref:t,class:"img",src:js,alt:"loading"},null,512))}}),gt=we(Vs,[["__scopeId","data-v-e69df7ef"]]),Qs={key:0,class:"container"},qs={class:"title"},Zs={class:"multi-color-progress"},Hs={class:"progress-outer"},Ks={class:"progress"},Ys={class:"percent"},Xs={class:"percent-text"},Gs="#52c41a",Js="#FFEB3B",eo="#f5222d",to="#bfbfbf",so=ce({__name:"UploadProgress",setup(e){const{dataSource:t,totalStatus:s,kbTotal:o}=le(Re()),n=de().progress,b=v({green:0,yellow:0,red:0,gray:0}),r=v({green:0,yellow:0,red:0,gray:0}),i=v({green:0,yellow:0,red:0,gray:0}),c=()=>{b.value=s.value;for(const x in b.value){const y=b.value[x]/o.value*100;r.value[x]=parseFloat(y.toFixed(2))}const u=100-Object.values(r.value).reduce((x,y)=>x+y,0);u>0&&(r.value.gray+=u),i.value.green=r.value.green,i.value.red=r.value.red+i.value.green,i.value.yellow=r.value.yellow+i.value.red,i.value.gray=r.value.gray+i.value.yellow};return Ce(()=>s,()=>{c()},{immediate:!0,deep:!0}),(w,u)=>{const x=Ns,y=Ue;return a(t).length!==0?($(),H("div",Qs,[_("span",qs,D(a(n).uploadTotalProgress)+"：",1),m(y,{title:`${a(n).putStorage}: ${a(b).green},
      ${a(n).inLine}: ${a(b).gray},
      ${a(n).parsing}: ${a(b).yellow},
      ${a(n).failure}: ${a(b).red}`},{default:T(()=>[_("div",Zs,[_("div",Hs,[_("div",Ks,[m(x,{percent:a(i).green,class:"progress-segment green",status:"active","stroke-color":Gs},null,8,["percent"]),m(x,{percent:a(i).red,class:"progress-segment red",status:"active","stroke-color":eo},null,8,["percent"]),m(x,{percent:a(i).yellow,class:"progress-segment yellow",status:"active","stroke-color":Js},null,8,["percent"]),m(x,{percent:a(i).gray,class:"progress-segment gray",status:"active","stroke-color":to},null,8,["percent"])])]),_("div",Ys,[_("div",Xs,D((a(r).green+a(r).red).toFixed(2))+"% ",1)])])]),_:1},8,["title"])])):te("",!0)}}}),oo=we(so,[["__scopeId","data-v-742741e5"]]),ao=e=>(bt("data-v-f053baeb"),e=e(),_t(),e),no={class:"container"},lo={class:"scale"},ro={class:"scale-text"},io={class:"file-preview-content"},co=ao(()=>_("div",{class:"resize-handle"},null,-1)),uo={class:"export"},po={style:{color:"#666","user-select":"text"}},go={class:"file-path"},fo={key:1},vo=["innerHTML"],mo={key:2,class:"editable-row-operations"},ho={key:0,class:"operation-div"},yo={class:"footer"},bo=ce({__name:"ChunkViewDialog",props:{kbId:{},fileId:{},fileName:{}},setup(e){const{showChunkModel:t}=le(St()),{common:s}=de(),{chatSettingFormActive:o}=le(wt()),{setSourceType:n,setSourceUrl:b,setTextContent:r}=ts(),i=e,{kbId:c,fileId:w,fileName:u}=jt(i),x=v([{title:"编号",key:"id",dataIndex:"id",width:70},{title:"markdown预览",key:"content",dataIndex:"content",resizable:!0,width:150,minWidth:150},{title:"分析结果",key:"editContent",dataIndex:"editContent",resizable:!0,width:150,minWidth:150},{title:"操作",key:"operation",dataIndex:"operation",width:100}]),y=v(new Map),d=f=>{const A=f.key,O=f.content;y.value.has(A)?y.value.delete(A):y.value.set(A,O)},p=(...f)=>{f[2].map(O=>{const q=O.key,S=O.content;y.value.has(q)?y.value.delete(q):y.value.set(q,S)})},g=()=>{let f="";[...y.value.values()].map(O=>{f+=O+`

`}),F(f)},F=f=>{try{const A="output.txt",O=new File([f],A,{type:"text/plain;charset=utf-8"}),q=URL.createObjectURL(O);Kt(q,A),y.value.clear()}catch{j.error("download error")}},E=v(!1),U=v(!1),R=v({pageNum:1,pageSize:5,total:0,showSizeChanger:!1,showTotal:f=>`共 ${f} 条`}),M=f=>{R.value.pageNum=f.current,C(c.value,w.value)},V=v([]),z=v({}),X=v(1),se=v(""),N=f=>{z.value[f]=JSON.parse(JSON.stringify(V.value.filter(A=>f===A.key)[0]))},h=async f=>{U.value=!0,j.warn("正在更新……");try{await ne(await ae.updateDocCompleted({chunk_size:o.value.chunkSize,doc_id:f,update_content:z.value[f].editContent})),j.success("修改成功"),Object.assign(V.value.filter(A=>f===A.key)[0],z[f]),delete z.value[f]}catch(A){j.error(A.msg)}finally{U.value=!1}},P=f=>{delete z.value[f]},I=()=>{t.value=!1,!U&&(z.value={})},l=v(1),Q=()=>{l.value+=.1},k=()=>{l.value<=.15||(l.value-=.1)},C=async(f,A)=>{E.value=!0;try{const O=await ne(await ae.getDocCompleted({kb_id:f,file_id:A,page_id:R.value.pageNum,page_limit:R.value.pageSize}));X.value=(R.value.pageNum-1)*R.value.pageSize+1,R.value.total=O.total_count,V.value=[],se.value=O.file_path,O.chunks.forEach(q=>{V.value.push({key:q.chunk_id,id:X.value++,content:q.page_content,editContent:q.page_content})})}catch(O){j.error(O.msg||"获取文档解析结果失败")}finally{E.value=!1}};Ce(()=>t.value,()=>{t.value?(V.value=[],C(c.value,w.value),ue({file_id:w.value,file_name:u.value})):t.value||(l.value=1,V.value=[],X.value=1,R.value.pageNum=1,R.value.total=1,b(""),r(""),y.value.clear())});let G=["pdf","docx","xlsx","txt","md","jpg","png","jpeg","csv","eml"];const oe=f=>{if(!f)return!1;const A=f.split(".");if(A.length){const O=A.pop();return!!G.includes(O)}else return!1},ue=f=>{oe(f.file_name)&&ye(f)};async function ye(f){try{b(null);const A=await ne(await ae.getFile({file_id:f.file_id})),O=f.file_name.split(".").pop(),q=Se(O);if(console.log("b64Type",q),n(O),b(`data:${q};base64,${A.file_base64}`),O==="txt"||O==="md"||O==="csv"||O==="eml"){const S=atob(A.file_base64),B=decodeURIComponent(escape(S));r(B)}}catch(A){j.error(A.msg||"获取文件失败")}}let Ae=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","text/markdown","image/jpeg","image/png","image/jpeg","text/csv","message/rfc822","application/vnd.openxmlformats-officedocument.presentationml.presentation"];function Se(f){const A=G.indexOf(f);return Ae[A]}const We=f=>f.replace(/\n/g,"<br />"),xe=v(null),Ie=()=>xe.value.clientWidth,$e=v(0),Oe=()=>{const q=document.querySelector(".chunk-table").querySelector('.ant-table-cell[colstart="3"]').clientWidth;return console.log("----",q),q>150},je=(f,A)=>{$e.value=Ie(),console.log($e.value),console.log(Oe()),console.log(f,A.width);const O=f<A.width?"left":"right";(Oe()||O==="left")&&(A.width=f)},ve=v(!1),De=v(0),Pe=v(0),Le=v("40%"),Ve=f=>{f>={min:300}.min&&(Le.value=`${f}px`)},Qe=f=>{console.log(f.target.classList),f.target.classList.contains("resize-handle")&&(ve.value=!0,De.value=f.clientX,Pe.value=f.target.parentElement.offsetWidth,window.addEventListener("mousemove",Fe),window.addEventListener("mouseup",Ne))},Fe=f=>{if(ve.value){const A=f.clientX-De.value,O=Pe.value+A;Ve(O)}},Ne=()=>{ve.value&&(ve.value=!1,window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",Ne))};return(f,A)=>{const O=Je,q=Ue,S=ns,B=es,re=At,Te=et,Ee=Qt;return $(),K(yt,{to:"body"},[m(Ee,{theme:{token:{colorPrimary:"#5a47e5"}}},{default:T(()=>[m(Te,{open:a(t),"onUpdate:open":A[0]||(A[0]=ie=>ht(t)?t.value=ie:null),title:"切片分析结果",centered:"",width:"100%","wrap-class-name":"chunk-modal","destroy-on-close":"",footer:null,onCancel:I},{default:T(()=>[_("div",no,[_("div",{class:"file-preview",style:Vt({width:a(Le)}),onMousedown:Qe},[_("div",lo,[m(O,{shape:"circle",icon:Ke(a(st)),onClick:Q},null,8,["icon"]),_("span",ro,D((a(l)*100).toFixed(0))+"%",1),m(O,{shape:"circle",icon:Ke(a(tt)),onClick:k},null,8,["icon"])]),_("div",io,[m(os,{"zoom-level":a(l)},null,8,["zoom-level"])]),co],36),_("div",{ref_key:"tableDomRef",ref:xe,class:"chunk-table"},[_("div",uo,[m(q,{color:"#fff",placement:"bottom"},{title:T(()=>[_("span",po,D(a(se)),1)]),default:T(()=>[_("span",go,"文件与解析结果所在目录: "+D(a(se)),1)]),_:1}),m(O,{type:"primary",onClick:g},{default:T(()=>[Y(" 导出选中("+D(a(y).size)+") ",1)]),_:1})]),m(re,{columns:a(x),"data-source":a(V),bordered:"",scroll:{y:"calc(100vh - 32px - 40px - 42px - 64px - 56px - 42px - 48px)"},pagination:a(R),loading:a(E),"row-selection":{selectedRowKeys:[...a(y).keys()],onSelect:d,onSelectAll:p},onChange:M,onResizeColumn:je},{bodyCell:T(({column:ie,record:J})=>[ie.dataIndex==="content"?($(),K(ss,{key:0,content:a(z)[J.key]?a(z)[J.key].editContent:J.content},null,8,["content"])):te("",!0),ie.dataIndex==="editContent"?($(),H("div",fo,[a(z)[J.key]?($(),K(S,{key:0,value:a(z)[J.key][ie.dataIndex],"onUpdate:value":Z=>a(z)[J.key][ie.dataIndex]=Z,style:{margin:"-5px 0"},"show-count":"","auto-size":""},null,8,["value","onUpdate:value"])):($(),H("div",{key:1,innerHTML:We(J.content)},null,8,vo))])):ie.dataIndex==="operation"?($(),H("div",mo,[a(z)[J.key]?($(),H("div",ho,[m(O,{class:"operation-btn",size:"small",loading:a(U),type:"link",onClick:Z=>h(J.key)},{default:T(()=>[Y(D(a(U)?"":a(s).save),1)]),_:2},1032,["loading","onClick"]),a(U)?te("",!0):($(),K(O,{key:0,class:"operation-btn",size:"small",loading:a(U),type:"text",onClick:Z=>P(J.key)},{default:T(()=>[Y(D(a(s).cancel),1)]),_:2},1032,["loading","onClick"]))])):($(),K(B,{key:1,onClick:Z=>N(J.key)},{default:T(()=>[Y(D(a(s).edit),1)]),_:2},1032,["onClick"]))])):te("",!0)]),_:1},8,["columns","data-source","scroll","pagination","loading","row-selection"])],512)]),_("div",yo,[m(O,{type:"primary",onClick:I},{default:T(()=>[Y(D(a(s).close),1)]),_:1})])]),_:1},8,["open"])]),_:1})])}}}),_o=we(bo,[["__scopeId","data-v-f053baeb"]]),ft=ke("useUploadFiles",()=>{const e=v([]),t=()=>{e.value=[]},s=v([]);return{uploadFileList:e,initUploadFileList:t,uploadFileListQuick:s,initUploadFileListQuick:()=>{s.value=[]}}}),ko={class:"file"},Co={class:"box"},wo={class:"before-upload-box"},Ao=["accept"],So={class:"before-upload"},xo={class:"upload-text-box"},Io={class:"upload-text"},$o={class:"blue"},Oo={class:"desc"},Do=125*1024*1024,Po=ce({__name:"FileUploadDialog",props:{dialogType:{type:Number,require:!0,default:0}},setup(e){const t=de().common,{setKnowledgeName:s,setModalVisible:o}=Ye(),{setDefault:n}=_e(),{getDetails:b}=Re(),{modalVisible:r,modalTitle:i}=le(Ye()),{currentId:c,currentKbName:w}=le(_e()),{uploadFileList:u,uploadFileListQuick:x}=le(ft()),{initUploadFileList:y}=ft(),{chatSettingFormActive:d}=le(wt()),p=e,g=v(),F=L(()=>c.value.length>0&&u.value.length>0&&u.value.every(N=>N.status!="loading"));Ce(()=>r.value,()=>{s(w.value),p.dialogType===1&&(u.value=x.value),!r.value&&p.dialogType===0&&y()});const E=[".md",".txt",".pdf",".jpg",".png",".jpeg",".docx",".xlsx",".pptx",".eml",".csv"],U={document:30*1024*1024,image:5*1024*1024},R=async(N,h)=>new Promise((P,I)=>{if(console.log(N),N.name&&E.includes("."+N.name.split(".").pop().toLowerCase())){const l=N.type.startsWith("image/")?U.image:U.document,Q=N.type.startsWith("image/")?"图片":"文档";if(N.size>l){I(`单个${Q}太大，不能超过 ${l/1024/1024} MB`);return}u.value.push({file_name:N.name,file:N,status:"loading",text:t.uploading,file_id:"",order:u.value.length,bytes:0}),P(h)}else I(`${N.name}的文件格式不符`)}),M=N=>{const h=N.target.files;let P=0;Array.from(h).forEach(I=>{if(P+=I.size,P>=Do){j.error("文件总大小超过125MB");return}}),Array.from(h).forEach(async(I,l)=>{try{await R(I,l)}catch(Q){j.error(Q)}}),setTimeout(()=>{u.value.length&&V()})},V=async()=>{var P;se();const N=[];u.value.forEach(I=>{I.status=="loading"&&N.push(I)});const h=new FormData;for(let I=0;I<N.length;I++)h.append("files",(P=N[I])==null?void 0:P.file);h.append("kb_id",c.value),h.append("user_id",Yt),h.append("chunk_size",d.value.chunkSize.toString()),h.append("mode","soft"),z(0),fetch(Xt+"/local_doc_qa/upload_files",{method:"POST",body:h}).then(I=>{if(I.ok)return I.json();throw new Error("上传失败")}).then(I=>{if(I.code===200){if(I.data.length===0){j.warn(I.msg||"出错了"),qe.close("upload"),p.dialogType===1&&N.forEach(l=>{u.value[l.order].status="error",u.value[l.order].errorText=(I==null?void 0:I.msg)||t.upFailed});return}z(1),p.dialogType===1&&N.forEach((l,Q)=>{let k=I.data[Q].status;k=="green"||k=="gray"?k="success":k="error",u.value[l.order].status=k,u.value[l.order].file_id=I.data[Q].file_id,u.value[l.order].bytes=I.data[Q].bytes,u.value[l.order].errorText=t.upSucceeded})}else j.error(I.msg||"出错了"),qe.close("upload"),N.forEach(l=>{u.value[l.order].status="error",u.value[l.order].errorText=(I==null?void 0:I.msg)||t.upFailed})}).finally(()=>{b()})},z=N=>{qe[N?"success":"info"]({key:"upload",message:N?"上传完成":"上传中",description:N?"":"最多需要30s",duration:N?2.5:0})},X=async()=>{o(!1),n(he.optionlist),await b()},se=()=>{o(!1)};return kt(()=>{g.value&&clearTimeout(g.value)}),(N,h)=>{const P=Je,I=et;return $(),K(yt,{to:"body"},[m(I,{open:a(r),"onUpdate:open":h[1]||(h[1]=l=>ht(r)?r.value=l:null),title:a(i),centered:"",width:"480px","wrap-class-name":"upload-file-modal","destroy-on-close":""},{footer:T(()=>[p.dialogType===0?($(),K(P,{key:"submit",type:"primary",class:"upload-btn",disabled:!a(F),onClick:X},{default:T(()=>[Y(D(a(t).confirm),1)]),_:1},8,["disabled"])):te("",!0),p.dialogType===1?($(),K(P,{key:"submit",type:"primary",class:"upload-btn",onClick:se},{default:T(()=>[Y(D(a(t).cancel),1)]),_:1})):te("",!0)]),default:T(()=>[_("div",ko,[_("div",Co,[_("div",wo,[_("input",{class:"hide input",type:"file",accept:E.join(","),multiple:"",onChange:M,onClick:h[0]||(h[0]=l=>l.target.value="")},null,40,Ao),_("div",So,[_("div",xo,[m(Ct,{name:"upload"}),_("p",null,[_("span",Io,[Y(D(a(t).dragUrl)+" ",1),_("span",$o,D(a(t).click),1)])])]),_("p",Oo,D(a(t).updesc1),1)])])])])]),_:1},8,["open","title"])])}}}),Lo=we(Po,[["__scopeId","data-v-244df073"]]),xt=e=>(bt("data-v-98037a09"),e=e(),_t(),e),Fo={class:"list-page"},No={class:"content"},To={class:"options"},Eo=xt(()=>_("img",{src:Bs,alt:"back"},null,-1)),Mo={class:"kb-name"},Ro={class:"name"},Uo={class:"id"},zo={class:"nav-info"},Bo={class:"navs"},Wo=["onClick"],jo={key:0,class:"nav-progress"},Vo={class:"handle-btn"},Qo={class:"table"},qo=xt(()=>_("img",{src:Ws,style:{width:"18px","margin-left":"5px"},alt:"©"},null,-1)),Zo={style:{color:"#666","user-select":"text"}},Ho={key:1,class:"status-box"},Ko={class:"icon-file-status"},Yo={key:0},Xo={key:1},Go={key:0,class:"status-box"},Jo={class:"icon-file-status"},ea={key:1,class:"options"},ta=ce({__name:"OptionList",setup(e){const{setDefault:t}=_e(),{currentKbName:s,currentId:o}=le(_e()),{setModalVisible:n,setUrlModalVisible:b,setModalTitle:r}=Ye(),{showChunkModel:i}=le(St()),{getDetails:c,setEditQaSet:w,setEditModalVisible:u,getFaqList:x,setFaqType:y,setPageNum:d,setKbPageNum:p}=Re(),{dataSource:g,faqList:F,timer:E,faqTimer:U,total:R,pageNum:M,pageSize:V,loading:z,kbTotal:X,kbPageNum:se,kbPageSize:N}=le(Re()),h=de().home,P=de().common,I=de().bots,l=v(0),Q=[{name:h.docSet,value:0},{name:h.qaSet,value:1}],k=[{title:h.documentId,dataIndex:"fileId",key:"fileId",width:"11%"},{title:h.documentName,dataIndex:"fileIdName",key:"fileIdName",width:"20%",ellipsis:!0},{title:h.documentStatus,dataIndex:"status",key:"status",width:"15%",ellipsis:!0},{title:h.fileSize,dataIndex:"bytes",key:"bytes",width:"10%"},{title:h.contentLength,dataIndex:"contentLength",key:"contentLength",width:"10%"},{title:h.creationDate,dataIndex:"createtime",key:"createtime",width:"11%"},{title:h.remark,dataIndex:"remark",key:"remark",width:"15%"},{title:h.operate,key:"options",width:"10%"}],C=[{title:"ID",dataIndex:"id",key:"id",width:"8%"},{title:h.question,dataIndex:"question",key:"question",width:"43%",ellipsis:!0},{title:h.status,dataIndex:"status",key:"status",width:"10%",ellipsis:!0},{title:h.characterCount,dataIndex:"bytes",key:"bytes",width:"10%"},{title:h.creationDate,dataIndex:"createtime",key:"createtime",width:"11%"},{title:h.operate,key:"options",width:"10%"}],G=L(()=>({current:se.value,pageSize:N.value,total:X.value,showSizeChanger:!1,showTotal:S=>`共 ${S} 条`})),oe=L(()=>({current:M.value,pageSize:V.value,total:R.value,showSizeChanger:!1,showTotal:S=>`共 ${S} 条`}));let ue={};const ye=S=>{ue=S},Ae=v(""),Se=v(""),We=async S=>{Ae.value=S.fileId,Se.value=S.fileIdName,i.value=!0},xe=async()=>{try{await ne(await ae.deleteFile({file_ids:[ue.fileId],kb_id:o.value})),j.success("删除成功"),await c(),se.value!==1&&g.value.length===0&&(se.value-=1,await c())}catch(S){j.error(S.msg||"删除失败")}};let Ie={};const $e=S=>{Ie=S},Oe=async()=>{try{await ne(await ae.deleteFile({kb_id:`${o.value}_FAQ`,file_ids:[Ie.faqId]})),j.success("删除成功"),await x(),M.value!==1&&F.value.length===0&&(M.value-=1,await x())}catch(S){j.error(S.msg||"删除失败")}},je=S=>{y("edit"),w(S),u(!0)},ve=()=>{t(he.normal)},De=()=>{n(!0),r(h.upload)},Pe=()=>{b(!0),r(P.addUrl)},Le=()=>{y("upload"),u(!0)},Ve=()=>{et.confirm({title:h.clearAllFile,content:Ke("p",h.clearAllFileConfirm),centered:!0,maskClosable:!0,okText:P.confirm,okType:"danger",async onOk(){try{await ne(await ae.clearUpload({status:"gray",kb_ids:[]})),j.success("操作成功"),c()}catch(S){j.error(S.msg||"操作失败")}}})},Qe=S=>{let B;switch(S){case"gray":B=P.inLine;break;case"yellow":B=P.parsing;break;case"green":B=P.succeeded;break;default:B=P.failed;break}return B},Fe=S=>{let B=P.failed;switch(S){case"gray":B=P.uploadCompleted;break;case"yellow":B=P.inLine;break;case"green":B=P.learningCompleted;break}return B},Ne=async()=>{try{if((await ne(await ae.kbList())).find(B=>B.kb_id===`${o.value}_FAQ`))return!0}catch(S){return j.error(S.msg||P.error),!0}return!1},f=async()=>{if(!await Ne()){try{await ne(await ae.createKb({kb_name:`${s.value}_FAQ`,kb_id:`${o.value}_FAQ`}))}catch(B){return j.error(B.msg||P.error),!1}return!0}},A=S=>{l.value=S,S===0?(p(1),clearTimeout(U.value),c()):(d(1),clearTimeout(E.value),x(),f())},O=S=>{const{current:B}=S;d(B),x()},q=S=>{p(S.current),c()};return Ce(o,()=>{l.value=0,p(1),d(1),c()},{immediate:!0}),kt(()=>{clearTimeout(E.value),clearTimeout(U.value),p(1),d(1)}),(S,B)=>{const re=Je,Te=Ue,Ee=Ct,ie=as,J=At;return $(),H(ge,null,[_("div",Fo,[_("div",No,[_("div",To,[_("div",{class:"to-chat",onClick:ve},[Eo,_("span",null,D(a(h).conversation),1)]),_("p",Mo,[_("span",Ro,D(a(s)),1),_("span",Uo,D(a(h).knowledgeID)+" "+D(a(o))+D(a(l)===1?"_FAQ":""),1)])]),_("div",zo,[_("div",Bo,[($(),H(ge,null,at(Q,Z=>_("div",{key:Z.name,class:qt(["nav-item",a(l)===Z.value?"nav-item-active":""]),onClick:W=>A(Z.value)},D(Z.name),11,Wo)),64))]),a(l)===0?($(),H("div",jo,[m(oo,{"data-source":a(g)},null,8,["data-source"])])):te("",!0),_("div",Vo,[a(l)===0?($(),K(re,{key:0,danger:"",class:"clear-upload",onClick:Ve},{default:T(()=>[Y(D(a(h).clearAllFile),1)]),_:1})):te("",!0),a(l)===0?($(),K(re,{key:1,class:"upload",onClick:De},{default:T(()=>[Y(D(a(h).upload),1)]),_:1})):te("",!0),a(l)===0?($(),K(re,{key:2,class:"add-link",onClick:Pe},{default:T(()=>[Y(D(a(h).addUrl),1)]),_:1})):te("",!0),a(l)===1?($(),K(re,{key:3,class:"upload",onClick:Le},{default:T(()=>[Y(D(a(h).inputQa),1)]),_:1})):te("",!0)])]),_("div",Qo,[a(l)===0?($(),K(J,{key:0,"data-source":a(g),columns:k,pagination:a(G),locale:{emptyText:a(h).emptyText},"hide-on-single-page":!0,"show-size-changer":!1,onChange:q},{headerCell:T(({column:Z})=>[Z.key==="status"?($(),H(ge,{key:0},[_("span",null,D(a(h).documentStatus),1),m(Te,{color:"#5a47e5"},{title:T(()=>[Y(D(a(h).documentStatusNode),1)]),default:T(()=>[qo]),_:1})],64)):te("",!0)]),bodyCell:T(({column:Z,record:W})=>[Z.key==="fileIdName"?($(),K(Te,{key:0,color:"#fff"},{title:T(()=>[_("span",Zo,D(W.fileIdName),1)]),default:T(()=>[_("span",null,D(W.fileIdName),1)]),_:2},1024)):Z.key==="status"?($(),H("div",Ho,[_("span",Ko,[W.status==="gray"||W.status==="yellow"?($(),K(gt,{key:0,class:"file-status"})):($(),K(Ee,{key:1,class:"file-status",name:W.status==="green"?"success":"error"},null,8,["name"]))]),_("span",null,D(Qe(W.status)),1)])):Z.key==="remark"?($(),H(ge,{key:2},[typeof W.remark=="string"?($(),H("div",Yo,D(W.remark),1)):($(),H("div",Xo,[($(!0),H(ge,null,at(W.remark,(be,ot)=>($(),H("p",{key:ot},D(`${ot}: ${be}`),1))),128))]))],64)):Z.key==="options"?($(),H(ge,{key:3},[m(ie,{"overlay-class-name":"del-pop",placement:"topRight",title:a(P).deleteTitle,"ok-text":a(P).confirm,"cancel-text":a(P).cancel,onConfirm:xe},{default:T(()=>[m(re,{type:"text",class:"delete-item",onClick:be=>ye(W)},{default:T(()=>[Y(D(a(P).delete),1)]),_:2},1032,["onClick"])]),_:2},1032,["title","ok-text","cancel-text"]),m(re,{type:"text",class:"view-item",disabled:W.status!=="green",onClick:be=>We(W)},{default:T(()=>[Y(D(a(P).view),1)]),_:2},1032,["disabled","onClick"])],64)):te("",!0)]),_:1},8,["data-source","pagination","locale"])):($(),K(J,{key:1,"data-source":a(F),columns:C,locale:{emptyText:a(h).emptyText},loading:a(z),pagination:a(oe),onChange:O},{bodyCell:T(({column:Z,record:W})=>[Z.key==="status"?($(),H("div",Go,[_("span",Jo,[W.status==="gray"||W.status==="yellow"?($(),K(gt,{key:0,class:"file-status"})):($(),K(Ee,{key:1,class:"file-status",name:W.status==="green"?"success":"error"},null,8,["name"]))]),_("span",null,D(Fe(W.status)),1)])):Z.key==="options"?($(),H("div",ea,[m(re,{class:"edit-item",type:"link",disabled:W.status!=="green",onClick:be=>je(W)},{default:T(()=>[Y(D(a(I).edit),1)]),_:2},1032,["disabled","onClick"]),m(ie,{"overlay-class-name":"qa-del-pop",placement:"topRight",title:a(h).deleteQaSetText,"ok-text":a(P).confirm,"cancel-text":a(P).cancel,onConfirm:Oe},{default:T(()=>[m(re,{class:"delete-item",danger:"",type:"link",onClick:be=>$e(W)},{default:T(()=>[Y(D(a(P).delete),1)]),_:2},1032,["onClick"])]),_:2},1032,["title","ok-text","cancel-text"])])):te("",!0)]),_:1},8,["data-source","locale","loading","pagination"]))])])]),m(_o,{"kb-id":a(o),"file-id":a(Ae),"file-name":a(Se)},null,8,["kb-id","file-id","file-name"]),m(Lo,{"dialog-type":0})],64)}}}),fa=we(ta,[["__scopeId","data-v-98037a09"]]);export{Lo as F,gt as L,fa as O,ga as _,_e as a,Ns as b,ft as c,he as p,Ye as u};
