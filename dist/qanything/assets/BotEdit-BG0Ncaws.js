import{_ as T}from"./bot-avatar-CBCRm2Zm.js";import{u as b}from"./useBots-CGdoslAV.js";import{r as g,u as h}from"./utils-Daiis6_Y.js";import{r as V}from"./router-CBmUEq_U.js";import{g as j}from"./index-Dazi2bDt.js";import{d as q,aB as D,r as B,V as G,a9 as K,o as d,f as u,G as i,u as n,v as k,D as y,F as N,af as A,aG as O,aC as C,j as P,aE as Q,aF as H,$ as J}from"./index-C5ueqVSw.js";import{S as M}from"./index-Bt-yWqAO.js";import"./axios-CCb-kr4I.js";import"./initDefaultProps-B9L7UfZz.js";const U=c=>(Q("data-v-f0ffc33e"),c=c(),H(),c),W={class:"container"},X={class:"bot-edit"},Y={key:0,class:"loading"},Z={key:1},tt={class:"header"},et=U(()=>i("img",{src:T,alt:"avatar"},null,-1)),st={class:"name"},ot={class:"tabs"},at=["onClick"],nt=q({__name:"BotEdit",setup(c){const{getCurrentRoute:w,changePage:_}=V(),{tabIndex:p,curBot:r}=D(b()),{setTabIndex:L,setCurBot:I,setKnowledgeList:S}=b(),m=j().bots,x=[{name:m.edit,value:0},{name:m.publish,value:1}],l=B(null),f=B(!0),E=G(O,{style:{fontSize:"48px"},spin:!0}),$=async t=>{try{let s=[...(await g(await h.kbList())).filter(e=>!/.*_FAQ$/.test(e.kb_name))];console.log("kbs",s,t),t&&t.length?s=s.map(e=>(t.some(a=>a===e.kb_id)?e.state=1:e.state=0,e)):s=s.map(e=>(e.state=0,e)),console.log("kbs2",s),S(s)}catch(o){C.error(o.msg||"获取知识库列表失败")}},F=async t=>{try{const o=await g(await h.queryBotInfo({bot_id:t}));I(o[0]),$(o[0].kb_ids),f.value=!1}catch(o){C.error(o.msg||"获取Bot信息失败")}};z();function z(){const t=w();console.log("zj-route",t),l.value=t.value.params.botId,F(l.value)}function R(t){t===1&&(!r.value.kb_ids||!r.value.kb_ids.length)||p.value!==t&&(L(t),_(t===0?`/bots/${l.value}/edit`:`/bots/${l.value}/publish`))}return(t,o)=>{var e;const v=M,s=K("router-view");return d(),u("div",W,[i("div",X,[n(f)?(d(),u("div",Y,[k(v,{indicator:n(E)},null,8,["indicator"])])):(d(),u("div",Z,[i("div",tt,[et,i("div",st,y((e=n(r))==null?void 0:e.bot_name),1),i("div",ot,[(d(),u(N,null,A(x,a=>i("div",{key:a.name,class:P(["tab-item",n(p)===a.value?"tab-active":"",(!n(r).kb_ids||!n(r).kb_ids.length)&&a.value===1?"tab-disable":""]),onClick:it=>R(a.value)},y(a.name),11,at)),64))])]),k(s)]))])])}}}),vt=J(nt,[["__scopeId","data-v-f0ffc33e"]]);export{vt as default};
