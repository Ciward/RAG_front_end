import{r as F,aK as wt,aw as de,aL as St,aM as xt,aN as Ze,ax as At,aO as ut,aP as qe,d as oe,c as I,ao as ae,v as c,as as G,F as le,q as $t,am as It,an as Ot,av as Pt,aQ as Dt,ap as Ft,aR as Lt,aS as Nt,aT as Rt,aA as Tt,aq as dt,aI as Et,l as Mt,al as zt,o as k,f as B,$ as fe,aB as te,w as Ne,u as n,G as p,D as x,y as O,E as H,t as Wt,z as V,R as pt,B as jt,V as Qe,C as X,a5 as gt,aC as q,aU as Ut,aE as ft,aF as mt,m as vt,aD as ht,aV as Ve,af as tt,j as Bt}from"./index-C5ueqVSw.js";import{d as Vt,r as re,u as ie,a as qt,b as Qt}from"./utils-Daiis6_Y.js";import{_ as Xt,b as De,a as Xe,u as Fe,c as ot,p as yt}from"./useUploadFiles-DQWWhNd-.js";import{g as pe}from"./index-Dazi2bDt.js";import{i as Ge}from"./initDefaultProps-B9L7UfZz.js";import{C as Zt}from"./index-DfEbSR-6.js";import{d as Gt,B as He}from"./RightOutlined-CQzT6T_P.js";import{_ as Re}from"./index-D9jmw5IA.js";import{u as _t}from"./useChatSetting-hc8PUGpz.js";import{u as Ht,_ as Kt,M as Ke}from"./useChatSource-H7bpI6mk.js";import{S as Yt}from"./index-CH4dUSUq.js";import{L as Jt}from"./ChatInfoPanel-BNealT-o.js";import{_ as bt,a as eo}from"./index-dxmTYXF3.js";import{_ as to}from"./ActionButton-CjNWFszI.js";const oo=()=>{const e=F(new Map),t=s=>o=>{e.value.set(s,o)};return wt(()=>{e.value=new Map}),[t,e]},so=["normal","exception","active","success"],Te=()=>({prefixCls:String,type:de(),percent:Number,format:St(),status:de(),showInfo:xt(),strokeWidth:Number,strokeLinecap:de(),strokeColor:Ze(),trailColor:String,width:Number,success:At(),gapDegree:Number,gapPosition:de(),size:ut([String,Number,Array]),steps:Number,successPercent:Number,title:String,progressStatus:de()});function ce(e){return!e||e<0?0:e>100?100:e}function Le(e){let{success:t,successPercent:s}=e,o=s;return t&&"progress"in t&&(Gt(!1,"Progress","`success.progress` is deprecated. Please use `success.percent` instead."),o=t.progress),t&&"percent"in t&&(o=t.percent),o}function no(e){let{percent:t,success:s,successPercent:o}=e;const a=ce(Le({success:s,successPercent:o}));return[a,ce(ce(t)-a)]}function ao(e){let{success:t={},strokeColor:s}=e;const{strokeColor:o}=t;return[o||qe.green,s||null]}const Ee=(e,t,s)=>{var o,a,m,l;let i=-1,d=-1;if(t==="step"){const P=s.steps,u=s.strokeWidth;typeof e=="string"||typeof e>"u"?(i=e==="small"?2:14,d=u??8):typeof e=="number"?[i,d]=[e,e]:[i=14,d=8]=e,i*=P}else if(t==="line"){const P=s==null?void 0:s.strokeWidth;typeof e=="string"||typeof e>"u"?d=P||(e==="small"?6:8):typeof e=="number"?[i,d]=[e,e]:[i=-1,d=8]=e}else(t==="circle"||t==="dashboard")&&(typeof e=="string"||typeof e>"u"?[i,d]=e==="small"?[60,60]:[120,120]:typeof e=="number"?[i,d]=[e,e]:(i=(a=(o=e[0])!==null&&o!==void 0?o:e[1])!==null&&a!==void 0?a:120,d=(l=(m=e[0])!==null&&m!==void 0?m:e[1])!==null&&l!==void 0?l:120));return{width:i,height:d}};var lo=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(s[o[a]]=e[o[a]]);return s};const ro=()=>ae(ae({},Te()),{strokeColor:Ze(),direction:de()}),io=e=>{let t=[];return Object.keys(e).forEach(s=>{const o=parseFloat(s.replace(/%/g,""));isNaN(o)||t.push({key:o,value:e[s]})}),t=t.sort((s,o)=>s.key-o.key),t.map(s=>{let{key:o,value:a}=s;return`${a} ${o}%`}).join(", ")},co=(e,t)=>{const{from:s=qe.blue,to:o=qe.blue,direction:a=t==="rtl"?"to left":"to right"}=e,m=lo(e,["from","to","direction"]);if(Object.keys(m).length!==0){const l=io(m);return{backgroundImage:`linear-gradient(${a}, ${l})`}}return{backgroundImage:`linear-gradient(${a}, ${s}, ${o})`}},uo=oe({compatConfig:{MODE:3},name:"ProgressLine",inheritAttrs:!1,props:ro(),setup(e,t){let{slots:s,attrs:o}=t;const a=I(()=>{const{strokeColor:v,direction:b}=e;return v&&typeof v!="string"?co(v,b):{backgroundColor:v}}),m=I(()=>e.strokeLinecap==="square"||e.strokeLinecap==="butt"?0:void 0),l=I(()=>e.trailColor?{backgroundColor:e.trailColor}:void 0),i=I(()=>{var v;return(v=e.size)!==null&&v!==void 0?v:[-1,e.strokeWidth||(e.size==="small"?6:8)]}),d=I(()=>Ee(i.value,"line",{strokeWidth:e.strokeWidth})),P=I(()=>{const{percent:v}=e;return ae({width:`${ce(v)}%`,height:`${d.value.height}px`,borderRadius:m.value},a.value)}),u=I(()=>Le(e)),A=I(()=>{const{success:v}=e;return{width:`${ce(u.value)}%`,height:`${d.value.height}px`,borderRadius:m.value,backgroundColor:v==null?void 0:v.strokeColor}}),f={width:d.value.width<0?"100%":d.value.width,height:`${d.value.height}px`};return()=>{var v;return c(le,null,[c("div",G(G({},o),{},{class:[`${e.prefixCls}-outer`,o.class],style:[o.style,f]}),[c("div",{class:`${e.prefixCls}-inner`,style:l.value},[c("div",{class:`${e.prefixCls}-bg`,style:P.value},null),u.value!==void 0?c("div",{class:`${e.prefixCls}-success-bg`,style:A.value},null):null])]),(v=s.default)===null||v===void 0?void 0:v.call(s)])}}}),po={percent:0,prefixCls:"vc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1},go=e=>{const t=F(null);return $t(()=>{const s=Date.now();let o=!1;e.value.forEach(a=>{const m=(a==null?void 0:a.$el)||a;if(!m)return;o=!0;const l=m.style;l.transitionDuration=".3s, .3s, .3s, .06s",t.value&&s-t.value<100&&(l.transitionDuration="0s, 0s")}),o&&(t.value=Date.now())}),e},fo={gapDegree:Number,gapPosition:{type:String},percent:{type:[Array,Number]},prefixCls:String,strokeColor:{type:[Object,String,Array]},strokeLinecap:{type:String},strokeWidth:Number,trailColor:String,trailWidth:Number,transition:String};var mo=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(s[o[a]]=e[o[a]]);return s};let st=0;function nt(e){return+e.replace("%","")}function at(e){return Array.isArray(e)?e:[e]}function lt(e,t,s,o){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,m=arguments.length>5?arguments[5]:void 0;const l=50-o/2;let i=0,d=-l,P=0,u=-2*l;switch(m){case"left":i=-l,d=0,P=2*l,u=0;break;case"right":i=l,d=0,P=-2*l,u=0;break;case"bottom":d=l,u=2*l;break}const A=`M 50,50 m ${i},${d}
   a ${l},${l} 0 1 1 ${P},${-u}
   a ${l},${l} 0 1 1 ${-P},${u}`,f=Math.PI*2*l,v={stroke:s,strokeDasharray:`${t/100*(f-a)}px ${f}px`,strokeDashoffset:`-${a/2+e/100*(f-a)}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s"};return{pathString:A,pathStyle:v}}const vo=oe({compatConfig:{MODE:3},name:"VCCircle",props:Ge(fo,po),setup(e){st+=1;const t=F(st),s=I(()=>at(e.percent)),o=I(()=>at(e.strokeColor)),[a,m]=oo();go(m);const l=()=>{const{prefixCls:i,strokeWidth:d,strokeLinecap:P,gapDegree:u,gapPosition:A}=e;let f=0;return s.value.map((v,b)=>{const h=o.value[b]||o.value[o.value.length-1],E=Object.prototype.toString.call(h)==="[object Object]"?`url(#${i}-gradient-${t.value})`:"",{pathString:L,pathStyle:R}=lt(f,v,h,d,u,A);f+=v;const T={key:b,d:L,stroke:E,"stroke-linecap":P,"stroke-width":d,opacity:v===0?0:1,"fill-opacity":"0",class:`${i}-circle-path`,style:R};return c("path",G({ref:a(b)},T),null)})};return()=>{const{prefixCls:i,strokeWidth:d,trailWidth:P,gapDegree:u,gapPosition:A,trailColor:f,strokeLinecap:v,strokeColor:b}=e,h=mo(e,["prefixCls","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","strokeColor"]),{pathString:E,pathStyle:L}=lt(0,100,f,d,u,A);delete h.percent;const R=o.value.find(N=>Object.prototype.toString.call(N)==="[object Object]"),T={d:E,stroke:f,"stroke-linecap":v,"stroke-width":P||d,"fill-opacity":"0",class:`${i}-circle-trail`,style:L};return c("svg",G({class:`${i}-circle`,viewBox:"0 0 100 100"},h),[R&&c("defs",null,[c("linearGradient",{id:`${i}-gradient-${t.value}`,x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[Object.keys(R).sort((N,Q)=>nt(N)-nt(Q)).map((N,Q)=>c("stop",{key:Q,offset:N,"stop-color":R[N]},null))])]),c("path",T,null),l().reverse()])}}}),ho=()=>ae(ae({},Te()),{strokeColor:Ze()}),yo=3,_o=e=>yo/e*100,bo=oe({compatConfig:{MODE:3},name:"ProgressCircle",inheritAttrs:!1,props:Ge(ho(),{trailColor:null}),setup(e,t){let{slots:s,attrs:o}=t;const a=I(()=>{var h;return(h=e.width)!==null&&h!==void 0?h:120}),m=I(()=>{var h;return(h=e.size)!==null&&h!==void 0?h:[a.value,a.value]}),l=I(()=>Ee(m.value,"circle")),i=I(()=>{if(e.gapDegree||e.gapDegree===0)return e.gapDegree;if(e.type==="dashboard")return 75}),d=I(()=>({width:`${l.value.width}px`,height:`${l.value.height}px`,fontSize:`${l.value.width*.15+6}px`})),P=I(()=>{var h;return(h=e.strokeWidth)!==null&&h!==void 0?h:Math.max(_o(l.value.width),6)}),u=I(()=>e.gapPosition||e.type==="dashboard"&&"bottom"||void 0),A=I(()=>no(e)),f=I(()=>Object.prototype.toString.call(e.strokeColor)==="[object Object]"),v=I(()=>ao({success:e.success,strokeColor:e.strokeColor})),b=I(()=>({[`${e.prefixCls}-inner`]:!0,[`${e.prefixCls}-circle-gradient`]:f.value}));return()=>{var h;const E=c(vo,{percent:A.value,strokeWidth:P.value,trailWidth:P.value,strokeColor:v.value,strokeLinecap:e.strokeLinecap,trailColor:e.trailColor,prefixCls:e.prefixCls,gapDegree:i.value,gapPosition:u.value},null);return c("div",G(G({},o),{},{class:[b.value,o.class],style:[o.style,d.value]}),[l.value.width<=20?c(Re,null,{default:()=>[c("span",null,[E])],title:s.default}):c(le,null,[E,(h=s.default)===null||h===void 0?void 0:h.call(s)])])}}}),ko=()=>ae(ae({},Te()),{steps:Number,strokeColor:ut(),trailColor:String}),Co=oe({compatConfig:{MODE:3},name:"Steps",props:ko(),setup(e,t){let{slots:s}=t;const o=I(()=>Math.round(e.steps*((e.percent||0)/100))),a=I(()=>{var i;return(i=e.size)!==null&&i!==void 0?i:[e.size==="small"?2:14,e.strokeWidth||8]}),m=I(()=>Ee(a.value,"step",{steps:e.steps,strokeWidth:e.strokeWidth||8})),l=I(()=>{const{steps:i,strokeColor:d,trailColor:P,prefixCls:u}=e,A=[];for(let f=0;f<i;f+=1){const v=Array.isArray(d)?d[f]:d,b={[`${u}-steps-item`]:!0,[`${u}-steps-item-active`]:f<=o.value-1};A.push(c("div",{key:f,class:b,style:{backgroundColor:f<=o.value-1?v:P,width:`${m.value.width/i}px`,height:`${m.value.height}px`}},null))}return A});return()=>{var i;return c("div",{class:`${e.prefixCls}-steps-outer`},[l.value,(i=s.default)===null||i===void 0?void 0:i.call(s)])}}}),wo=new Dt("antProgressActive",{"0%":{transform:"translateX(-100%) scaleX(0)",opacity:.1},"20%":{transform:"translateX(-100%) scaleX(0)",opacity:.5},to:{transform:"translateX(0) scaleX(1)",opacity:0}}),So=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:ae(ae({},Pt(e)),{display:"inline-block","&-rtl":{direction:"rtl"},"&-line":{position:"relative",width:"100%",fontSize:e.fontSize,marginInlineEnd:e.marginXS,marginBottom:e.marginXS},[`${t}-outer`]:{display:"inline-block",width:"100%"},[`&${t}-show-info`]:{[`${t}-outer`]:{marginInlineEnd:`calc(-2em - ${e.marginXS}px)`,paddingInlineEnd:`calc(2em + ${e.paddingXS}px)`}},[`${t}-inner`]:{position:"relative",display:"inline-block",width:"100%",overflow:"hidden",verticalAlign:"middle",backgroundColor:e.progressRemainingColor,borderRadius:e.progressLineRadius},[`${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorInfo}},[`${t}-success-bg, ${t}-bg`]:{position:"relative",backgroundColor:e.colorInfo,borderRadius:e.progressLineRadius,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`},[`${t}-success-bg`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,backgroundColor:e.colorSuccess},[`${t}-text`]:{display:"inline-block",width:"2em",marginInlineStart:e.marginXS,color:e.progressInfoTextColor,lineHeight:1,whiteSpace:"nowrap",textAlign:"start",verticalAlign:"middle",wordBreak:"normal",[s]:{fontSize:e.fontSize}},[`&${t}-status-active`]:{[`${t}-bg::before`]:{position:"absolute",inset:0,backgroundColor:e.colorBgContainer,borderRadius:e.progressLineRadius,opacity:0,animationName:wo,animationDuration:e.progressActiveMotionDuration,animationTimingFunction:e.motionEaseOutQuint,animationIterationCount:"infinite",content:'""'}},[`&${t}-status-exception`]:{[`${t}-bg`]:{backgroundColor:e.colorError},[`${t}-text`]:{color:e.colorError}},[`&${t}-status-exception ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorError}},[`&${t}-status-success`]:{[`${t}-bg`]:{backgroundColor:e.colorSuccess},[`${t}-text`]:{color:e.colorSuccess}},[`&${t}-status-success ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorSuccess}}})}},xo=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:{[`${t}-circle-trail`]:{stroke:e.progressRemainingColor},[`&${t}-circle ${t}-inner`]:{position:"relative",lineHeight:1,backgroundColor:"transparent"},[`&${t}-circle ${t}-text`]:{position:"absolute",insetBlockStart:"50%",insetInlineStart:0,width:"100%",margin:0,padding:0,color:e.colorText,lineHeight:1,whiteSpace:"normal",textAlign:"center",transform:"translateY(-50%)",[s]:{fontSize:`${e.fontSize/e.fontSizeSM}em`}},[`${t}-circle&-status-exception`]:{[`${t}-text`]:{color:e.colorError}},[`${t}-circle&-status-success`]:{[`${t}-text`]:{color:e.colorSuccess}}},[`${t}-inline-circle`]:{lineHeight:1,[`${t}-inner`]:{verticalAlign:"bottom"}}}},Ao=e=>{const{componentCls:t}=e;return{[t]:{[`${t}-steps`]:{display:"inline-block","&-outer":{display:"flex",flexDirection:"row",alignItems:"center"},"&-item":{flexShrink:0,minWidth:e.progressStepMinWidth,marginInlineEnd:e.progressStepMarginInlineEnd,backgroundColor:e.progressRemainingColor,transition:`all ${e.motionDurationSlow}`,"&-active":{backgroundColor:e.colorInfo}}}}}},$o=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:{[`${t}-small&-line, ${t}-small&-line ${t}-text ${s}`]:{fontSize:e.fontSizeSM}}}},Io=It("Progress",e=>{const t=e.marginXXS/2,s=Ot(e,{progressLineRadius:100,progressInfoTextColor:e.colorText,progressDefaultColor:e.colorInfo,progressRemainingColor:e.colorFillSecondary,progressStepMarginInlineEnd:t,progressStepMinWidth:t,progressActiveMotionDuration:"2.4s"});return[So(s),xo(s),Ao(s),$o(s)]});var Oo=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(s[o[a]]=e[o[a]]);return s};const Po=oe({compatConfig:{MODE:3},name:"AProgress",inheritAttrs:!1,props:Ge(Te(),{type:"line",percent:0,showInfo:!0,trailColor:null,size:"default",strokeLinecap:"round"}),slots:Object,setup(e,t){let{slots:s,attrs:o}=t;const{prefixCls:a,direction:m}=Ft("progress",e),[l,i]=Io(a),d=I(()=>Array.isArray(e.strokeColor)?e.strokeColor[0]:e.strokeColor),P=I(()=>{const{percent:b=0}=e,h=Le(e);return parseInt(h!==void 0?h.toString():b.toString(),10)}),u=I(()=>{const{status:b}=e;return!so.includes(b)&&P.value>=100?"success":b||"normal"}),A=I(()=>{const{type:b,showInfo:h,size:E}=e,L=a.value;return{[L]:!0,[`${L}-inline-circle`]:b==="circle"&&Ee(E,"circle").width<=20,[`${L}-${b==="dashboard"&&"circle"||b}`]:!0,[`${L}-status-${u.value}`]:!0,[`${L}-show-info`]:h,[`${L}-${E}`]:E,[`${L}-rtl`]:m.value==="rtl",[i.value]:!0}}),f=I(()=>typeof e.strokeColor=="string"||Array.isArray(e.strokeColor)?e.strokeColor:void 0),v=()=>{const{showInfo:b,format:h,type:E,percent:L,title:R}=e,T=Le(e);if(!b)return null;let N;const Q=h||(s==null?void 0:s.format)||(se=>`${se}%`),W=E==="line";return h||s!=null&&s.format||u.value!=="exception"&&u.value!=="success"?N=Q(ce(L),ce(T)):u.value==="exception"?N=W?c(Lt,null,null):c(Nt,null,null):u.value==="success"&&(N=W?c(Rt,null,null):c(Zt,null,null)),c("span",{class:`${a.value}-text`,title:R===void 0&&typeof N=="string"?N:void 0},[N])};return()=>{const{type:b,steps:h,title:E}=e,{class:L}=o,R=Oo(o,["class"]),T=v();let N;return b==="line"?N=h?c(Co,G(G({},e),{},{strokeColor:f.value,prefixCls:a.value,steps:h}),{default:()=>[T]}):c(uo,G(G({},e),{},{strokeColor:d.value,prefixCls:a.value,direction:m.value}),{default:()=>[T]}):(b==="circle"||b==="dashboard")&&(N=c(bo,G(G({},e),{},{prefixCls:a.value,strokeColor:d.value,progressStatus:u.value}),{default:()=>[T]})),l(c("div",G(G({role:"progressbar"},R),{},{class:[A.value,L],title:E}),[N]))}}}),Do=Tt(Po);var Fo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};function rt(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?Object(arguments[t]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),o.forEach(function(a){Lo(e,a,s[a])})}return e}function Lo(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Ye=function(t,s){var o=rt({},t,s.attrs);return c(dt,rt({},o,{icon:Fo}),null)};Ye.displayName="MinusCircleOutlined";Ye.inheritAttrs=!1;var No={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};function it(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?Object(arguments[t]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),o.forEach(function(a){Ro(e,a,s[a])})}return e}function Ro(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Je=function(t,s){var o=it({},t,s.attrs);return c(dt,it({},o,{icon:No}),null)};Je.displayName="PlusCircleOutlined";Je.inheritAttrs=!1;const un="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAIhSURBVFiF7dkxj6JAFMDx98ZLtMHYGRIKr7Tbzo7O0mQTSr6D+xE29wl273tQbE9hbbed5ZlAhqFDDIkm8N41q3cr6+0OcGI2+y/NjPMLGcEMCCdFUTQionsAuEHEkRBicDqmyYgoYeYEEZ8Q8adpmuuzg6WUD0opzrKMi6LgS5XnOWdZxkopllI+nMMtkiS5GOpcaZqylHJRunJpmrZtO5YkyfFKYhRFI0T8NRwOm9tYDRTHMTDzd8HMd4ZhtO0pZRgGENG9YObbbrfbtqdUr9cDALgRiDjodDpte0oJIeDlNvd/73N1EkIMRNuI9/oC1u3zAcMwhDRNtReqOk8buFqtYDabQRiGH54ThiG4rgvL5VJ3OQCllPaz0vM8tm2bgyB4d2wQBGzbNnuep72OUoorAZk/hqyDqw1k/jeyLq4RIPPbyCZwjQGZXyObwh2A3/R/VuUcxwEAANd1AQBgPp8fP6tbI0CAP8h+vw/T6bSprwVUSvG1/Zs+FMfxJ3zUXTrtPej7Pvi+X2kxx3FgMplozdEGjsfjSg/9w1zdtIGWZYFlWdoLVe3q9+AXsG7XDySipG3EuYgoEcy8JqK2LaWKogBmTgQAPO92u7Y9pfb7PSDi0/Ufv5mmuSaix81m07bp2Ha7BSJ6fHVeLaVcXMMp68vp6uJN+d+H6HmeXwxVFMXZQ3Q8RUZRNGLmO2a+RcTBhV5DrAHgWQjx4/Q1xG82m1G/NnWY4wAAAABJRU5ErkJggg==",To="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAKFSURBVFiF1ZjNattAEIC/VH0Ag3O3wb0b+gKF0HMCfoAW/AAFP0ALaZ8guffQvoFzzsF5hNwLUu4F+Q2mB+1Yk9XfriTXycAiWdbufDuz2p2ZMxFJeMHy5tQAXfJ2YP8J8AGYufuZe/4E7N31wd3/N8AJ8Am4Apbud5dsgTvgV6yys8g1+AX4ZqD2wKNrajEoLbqksLBKBvyIAhWRJKC9F5FUStmJyEpEpgF9p+7dnemfisgiRHcI4FpEcgN2ETipprF0orkDHwR4bWZ9MwDMbzdm3Ou+gCszyGZEuLrJr2MBF1K6tXWGA9vG6cilWOfBgKnrOKZbu9ydhgKu2zoEtoWzTshXnkj5hVeWUh2gWq9xXQTA6Riha/fCvZ/7k/IB1Xq7EeDSCAs2WtEPFi7d9Tb8cDnIHLh31wz4SNwZrDqv7EN71E2Av+7+PHLwOrgsor/q/+Pu36l+a0E9M2OjjzHgoDzXNULCB9RQ6fEEcCqq+xAhWUAboZwCzupWY9Va8Ikw+cm4cFZ3LWCszLpfGS4WsELfIWq1OaWrh0rFixZQ/R8SwsNz184ZB7LyHdRZcBkxYMa4kKr7YEF/o65slIFi4TL6b9SVg8J3cWWjDBQLZWFjRHVuaXCx/glF9hYrGcMgVefds6deRDGVMpLumxz1CbcaY9C6eFDD8L4hl040JmDVCVVi0FcZ8idSJDDq6mNkdNo0s8ulIZFvSzt1XYgcJ7PbmPEbE/hXnbhrW0np7lT6J1OJFDuD5h55yFihxaOFjF88qk3U/RZbfvsMfPU24Afay2+2hrgHvhORlMUCWtBLvAysQfQI3QK/iay29gVUaSsBaxl4UAl4KODR5cVX+f8BBZDb8KKHVtYAAAAASUVORK5CYII=",Eo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAP5JREFUOE+tlNENgzAMRM1khY28QcsG3qgwWauz4ujiJKBKzRcY5+U421nkT2uZcVR1FZEnfT/xbGav0Z4ONADsIgIo1qM87xnYgFQVp0FFlxgqZjkVRAmbmR3YSDG8Ax5xKHyLSM1l0IeV0C/CGwCwsSothzzMbMOhDsrBEouNrK4xW1VrDoNy0hq/QmDkuIIcCxDI56y0I8UF5C0COIOqmdwn4RUrSRV0nxjUyB4l50YsSt2SAFWJk+SD/UoeuSVc/kufJgfAH2cwqGsyqkxTiOJb01e3I1I2oRV8WG9HZDBLaESf+NLZfBN0Fb66RuK6wMTHGrZI41E289f3L/XxvhPPyll2AAAAAElFTkSuQmCC",kt=Et("useChunkView",()=>({showChunkModel:F(!1)})),Mo=oe({__name:"LoadingImg",setup(e){const t=F(),s=()=>{t.value&&t.value.classList.add("loading")},o=()=>{t.value&&t.value.classList.remove("loading")};return Mt(()=>{s()}),zt(()=>{o()}),(a,m)=>(k(),B("img",{ref_key:"loadingRef",ref:t,class:"img",src:Xt,alt:"loading"},null,512))}}),ct=fe(Mo,[["__scopeId","data-v-e69df7ef"]]),zo={key:0,class:"container"},Wo={class:"title"},jo={class:"multi-color-progress"},Uo={class:"progress-outer"},Bo={class:"progress"},Vo={class:"percent"},qo={class:"percent-text"},Qo="#52c41a",Xo="#FFEB3B",Zo="#f5222d",Go="#bfbfbf",Ho=oe({__name:"UploadProgress",setup(e){const{dataSource:t,totalStatus:s,kbTotal:o}=te(De()),a=pe().progress,m=F({green:0,yellow:0,red:0,gray:0}),l=F({green:0,yellow:0,red:0,gray:0}),i=F({green:0,yellow:0,red:0,gray:0}),d=()=>{m.value=s.value;for(const A in m.value){const f=m.value[A]/o.value*100;l.value[A]=parseFloat(f.toFixed(2))}const u=100-Object.values(l.value).reduce((A,f)=>A+f,0);u>0&&(l.value.gray+=u),i.value.green=l.value.green,i.value.red=l.value.red+i.value.green,i.value.yellow=l.value.yellow+i.value.red,i.value.gray=l.value.gray+i.value.yellow};return Ne(()=>s,()=>{d()},{immediate:!0,deep:!0}),(P,u)=>{const A=Do,f=Re;return n(t).length!==0?(k(),B("div",zo,[p("span",Wo,x(n(a).uploadTotalProgress)+"：",1),c(f,{title:`${n(a).putStorage}: ${n(m).green},
      ${n(a).inLine}: ${n(m).gray},
      ${n(a).parsing}: ${n(m).yellow},
      ${n(a).failure}: ${n(m).red}`},{default:O(()=>[p("div",jo,[p("div",Uo,[p("div",Bo,[c(A,{percent:n(i).green,class:"progress-segment green",status:"active","stroke-color":Qo},null,8,["percent"]),c(A,{percent:n(i).red,class:"progress-segment red",status:"active","stroke-color":Zo},null,8,["percent"]),c(A,{percent:n(i).yellow,class:"progress-segment yellow",status:"active","stroke-color":Xo},null,8,["percent"]),c(A,{percent:n(i).gray,class:"progress-segment gray",status:"active","stroke-color":Go},null,8,["percent"])])]),p("div",Vo,[p("div",qo,x((n(l).green+n(l).red).toFixed(2))+"% ",1)])])]),_:1},8,["title"])])):H("",!0)}}}),Ko=fe(Ho,[["__scopeId","data-v-742741e5"]]),Yo=e=>(ft("data-v-f053baeb"),e=e(),mt(),e),Jo={class:"container"},es={class:"scale"},ts={class:"scale-text"},os={class:"file-preview-content"},ss=Yo(()=>p("div",{class:"resize-handle"},null,-1)),ns={class:"export"},as={style:{color:"#666","user-select":"text"}},ls={class:"file-path"},rs={key:1},is=["innerHTML"],cs={key:2,class:"editable-row-operations"},us={key:0,class:"operation-div"},ds={class:"footer"},ps=oe({__name:"ChunkViewDialog",props:{kbId:{},fileId:{},fileName:{}},setup(e){const{showChunkModel:t}=te(kt()),{common:s}=pe(),{chatSettingFormActive:o}=te(_t()),{setSourceType:a,setSourceUrl:m,setTextContent:l}=Ht(),i=e,{kbId:d,fileId:P,fileName:u}=Wt(i),A=F([{title:"编号",key:"id",dataIndex:"id",width:70},{title:"markdown预览",key:"content",dataIndex:"content",resizable:!0,width:150,minWidth:150},{title:"分析结果",key:"editContent",dataIndex:"editContent",resizable:!0,width:150,minWidth:150},{title:"操作",key:"operation",dataIndex:"operation",width:100}]),f=F(new Map),v=r=>{const y=r.key,S=r.content;f.value.has(y)?f.value.delete(y):f.value.set(y,S)},b=(...r)=>{r[2].map(S=>{const j=S.key,_=S.content;f.value.has(j)?f.value.delete(j):f.value.set(j,_)})},h=()=>{let r="";[...f.value.values()].map(S=>{r+=S+`

`}),E(r)},E=r=>{try{const y="output.txt",S=new File([r],y,{type:"text/plain;charset=utf-8"}),j=URL.createObjectURL(S);Vt(j,y),f.value.clear()}catch{q.error("download error")}},L=F(!1),R=F(!1),T=F({pageNum:1,pageSize:5,total:0,showSizeChanger:!1,showTotal:r=>`共 ${r} 条`}),N=r=>{T.value.pageNum=r.current,me(d.value,P.value)},Q=F([]),W=F({}),se=F(1),Y=F(""),D=r=>{W.value[r]=JSON.parse(JSON.stringify(Q.value.filter(y=>r===y.key)[0]))},g=async r=>{R.value=!0,q.warn("正在更新……");try{await re(await ie.updateDocCompleted({chunk_size:o.value.chunkSize,doc_id:r,update_content:W.value[r].editContent})),q.success("修改成功"),Object.assign(Q.value.filter(y=>r===y.key)[0],W[r]),delete W.value[r]}catch(y){q.error(y.msg)}finally{R.value=!1}},$=r=>{delete W.value[r]},C=()=>{t.value=!1,!R&&(W.value={})},w=F(1),K=()=>{w.value+=.1},ne=()=>{w.value<=.15||(w.value-=.1)},me=async(r,y)=>{L.value=!0;try{const S=await re(await ie.getDocCompleted({kb_id:r,file_id:y,page_id:T.value.pageNum,page_limit:T.value.pageSize}));se.value=(T.value.pageNum-1)*T.value.pageSize+1,T.value.total=S.total_count,Q.value=[],Y.value=S.file_path,S.chunks.forEach(j=>{Q.value.push({key:j.chunk_id,id:se.value++,content:j.page_content,editContent:j.page_content})})}catch(S){q.error(S.msg||"获取文档解析结果失败")}finally{L.value=!1}};Ne(()=>t.value,()=>{t.value?(Q.value=[],me(d.value,P.value),he({file_id:P.value,file_name:u.value})):t.value||(w.value=1,Q.value=[],se.value=1,T.value.pageNum=1,T.value.total=1,m(""),l(""),f.value.clear())});let ve=["pdf","docx","xlsx","txt","md","jpg","png","jpeg","csv","eml"];const Me=r=>{if(!r)return!1;const y=r.split(".");if(y.length){const S=y.pop();return!!ve.includes(S)}else return!1},he=r=>{Me(r.file_name)&&ze(r)};async function ze(r){try{m(null);const y=await re(await ie.getFile({file_id:r.file_id})),S=r.file_name.split(".").pop(),j=_e(S);if(console.log("b64Type",j),a(S),m(`data:${j};base64,${y.file_base64}`),S==="txt"||S==="md"||S==="csv"||S==="eml"){const _=atob(y.file_base64),M=decodeURIComponent(escape(_));l(M)}}catch(y){q.error(y.msg||"获取文件失败")}}let ye=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","text/markdown","image/jpeg","image/png","image/jpeg","text/csv","message/rfc822","application/vnd.openxmlformats-officedocument.presentationml.presentation"];function _e(r){const y=ve.indexOf(r);return ye[y]}const We=r=>r.replace(/\n/g,"<br />"),be=F(null),ke=()=>be.value.clientWidth,Ce=F(0),we=()=>{const j=document.querySelector(".chunk-table").querySelector('.ant-table-cell[colstart="3"]').clientWidth;return console.log("----",j),j>150},je=(r,y)=>{Ce.value=ke(),console.log(Ce.value),console.log(we()),console.log(r,y.width);const S=r<y.width?"left":"right";(we()||S==="left")&&(y.width=r)},ue=F(!1),Se=F(0),xe=F(0),Ae=F("40%"),Ue=r=>{r>={min:300}.min&&(Ae.value=`${r}px`)},Be=r=>{console.log(r.target.classList),r.target.classList.contains("resize-handle")&&(ue.value=!0,Se.value=r.clientX,xe.value=r.target.parentElement.offsetWidth,window.addEventListener("mousemove",$e),window.addEventListener("mouseup",Ie))},$e=r=>{if(ue.value){const y=r.clientX-Se.value,S=xe.value+y;Ue(S)}},Ie=()=>{ue.value&&(ue.value=!1,window.removeEventListener("mousemove",$e),window.removeEventListener("mouseup",Ie))};return(r,y)=>{const S=He,j=Re,_=to,M=Jt,J=bt,Oe=Ke,Pe=Ut;return k(),V(gt,{to:"body"},[c(Pe,{theme:{token:{colorPrimary:"#5a47e5"}}},{default:O(()=>[c(Oe,{open:n(t),"onUpdate:open":y[0]||(y[0]=ee=>pt(t)?t.value=ee:null),title:"切片分析结果",centered:"",width:"100%","wrap-class-name":"chunk-modal","destroy-on-close":"",footer:null,onCancel:C},{default:O(()=>[p("div",Jo,[p("div",{class:"file-preview",style:jt({width:n(Ae)}),onMousedown:Be},[p("div",es,[c(S,{shape:"circle",icon:Qe(n(Je)),onClick:K},null,8,["icon"]),p("span",ts,x((n(w)*100).toFixed(0))+"%",1),c(S,{shape:"circle",icon:Qe(n(Ye)),onClick:ne},null,8,["icon"])]),p("div",os,[c(Yt,{"zoom-level":n(w)},null,8,["zoom-level"])]),ss],36),p("div",{ref_key:"tableDomRef",ref:be,class:"chunk-table"},[p("div",ns,[c(j,{color:"#fff",placement:"bottom"},{title:O(()=>[p("span",as,x(n(Y)),1)]),default:O(()=>[p("span",ls,"文件与解析结果所在目录: "+x(n(Y)),1)]),_:1}),c(S,{type:"primary",onClick:h},{default:O(()=>[X(" 导出选中("+x(n(f).size)+") ",1)]),_:1})]),c(J,{columns:n(A),"data-source":n(Q),bordered:"",scroll:{y:"calc(100vh - 32px - 40px - 42px - 64px - 56px - 42px - 48px)"},pagination:n(T),loading:n(L),"row-selection":{selectedRowKeys:[...n(f).keys()],onSelect:v,onSelectAll:b},onChange:N,onResizeColumn:je},{bodyCell:O(({column:ee,record:Z})=>[ee.dataIndex==="content"?(k(),V(Kt,{key:0,content:n(W)[Z.key]?n(W)[Z.key].editContent:Z.content},null,8,["content"])):H("",!0),ee.dataIndex==="editContent"?(k(),B("div",rs,[n(W)[Z.key]?(k(),V(_,{key:0,value:n(W)[Z.key][ee.dataIndex],"onUpdate:value":U=>n(W)[Z.key][ee.dataIndex]=U,style:{margin:"-5px 0"},"show-count":"","auto-size":""},null,8,["value","onUpdate:value"])):(k(),B("div",{key:1,innerHTML:We(Z.content)},null,8,is))])):ee.dataIndex==="operation"?(k(),B("div",cs,[n(W)[Z.key]?(k(),B("div",us,[c(S,{class:"operation-btn",size:"small",loading:n(R),type:"link",onClick:U=>g(Z.key)},{default:O(()=>[X(x(n(R)?"":n(s).save),1)]),_:2},1032,["loading","onClick"]),n(R)?H("",!0):(k(),V(S,{key:0,class:"operation-btn",size:"small",loading:n(R),type:"text",onClick:U=>$(Z.key)},{default:O(()=>[X(x(n(s).cancel),1)]),_:2},1032,["loading","onClick"]))])):(k(),V(M,{key:1,onClick:U=>D(Z.key)},{default:O(()=>[X(x(n(s).edit),1)]),_:2},1032,["onClick"]))])):H("",!0)]),_:1},8,["columns","data-source","scroll","pagination","loading","row-selection"])],512)]),p("div",ds,[c(S,{type:"primary",onClick:C},{default:O(()=>[X(x(n(s).close),1)]),_:1})])]),_:1},8,["open"])]),_:1})])}}}),gs=fe(ps,[["__scopeId","data-v-f053baeb"]]),fs={class:"file"},ms={class:"box"},vs={class:"before-upload-box"},hs=["accept"],ys={class:"before-upload"},_s={class:"upload-text-box"},bs={class:"upload-text"},ks={class:"blue"},Cs={class:"desc"},ws=125*1024*1024,Ss=oe({__name:"FileUploadDialog",props:{dialogType:{type:Number,require:!0,default:0}},setup(e){const t=pe().common,{setKnowledgeName:s,setModalVisible:o}=Xe(),{setDefault:a}=Fe(),{getDetails:m}=De(),{modalVisible:l,modalTitle:i}=te(Xe()),{currentId:d,currentKbName:P}=te(Fe()),{uploadFileList:u,uploadFileListQuick:A}=te(ot()),{initUploadFileList:f}=ot(),{chatSettingFormActive:v}=te(_t()),b=e,h=F(),E=I(()=>d.value.length>0&&u.value.length>0&&u.value.every(D=>D.status!="loading"));Ne(()=>l.value,()=>{s(P.value),b.dialogType===1&&(u.value=A.value),!l.value&&b.dialogType===0&&f()});const L=[".md",".txt",".pdf",".jpg",".png",".jpeg",".docx",".xlsx",".pptx",".eml",".csv"],R={document:30*1024*1024,image:5*1024*1024},T=async(D,g)=>new Promise(($,C)=>{if(console.log(D),D.name&&L.includes("."+D.name.split(".").pop().toLowerCase())){const w=D.type.startsWith("image/")?R.image:R.document,K=D.type.startsWith("image/")?"图片":"文档";if(D.size>w){C(`单个${K}太大，不能超过 ${w/1024/1024} MB`);return}u.value.push({file_name:D.name,file:D,status:"loading",text:t.uploading,file_id:"",order:u.value.length,bytes:0}),$(g)}else C(`${D.name}的文件格式不符`)}),N=D=>{const g=D.target.files;let $=0;Array.from(g).forEach(C=>{if($+=C.size,$>=ws){q.error("文件总大小超过125MB");return}}),Array.from(g).forEach(async(C,w)=>{try{await T(C,w)}catch(K){q.error(K)}}),setTimeout(()=>{u.value.length&&Q()})},Q=async()=>{var $;Y();const D=[];u.value.forEach(C=>{C.status=="loading"&&D.push(C)});const g=new FormData;for(let C=0;C<D.length;C++)g.append("files",($=D[C])==null?void 0:$.file);g.append("kb_id",d.value),g.append("user_id",qt),g.append("chunk_size",v.value.chunkSize.toString()),g.append("mode","soft"),W(0),fetch(Qt+"/local_doc_qa/upload_files",{method:"POST",body:g}).then(C=>{if(C.ok)return C.json();throw new Error("上传失败")}).then(C=>{if(C.code===200){if(C.data.length===0){q.warn(C.msg||"出错了"),Ve.close("upload"),b.dialogType===1&&D.forEach(w=>{u.value[w.order].status="error",u.value[w.order].errorText=(C==null?void 0:C.msg)||t.upFailed});return}W(1),b.dialogType===1&&D.forEach((w,K)=>{let ne=C.data[K].status;ne=="green"||ne=="gray"?ne="success":ne="error",u.value[w.order].status=ne,u.value[w.order].file_id=C.data[K].file_id,u.value[w.order].bytes=C.data[K].bytes,u.value[w.order].errorText=t.upSucceeded})}else q.error(C.msg||"出错了"),Ve.close("upload"),D.forEach(w=>{u.value[w.order].status="error",u.value[w.order].errorText=(C==null?void 0:C.msg)||t.upFailed})}).finally(()=>{m()})},W=D=>{Ve[D?"success":"info"]({key:"upload",message:D?"上传完成":"上传中",description:D?"":"最多需要30s",duration:D?2.5:0})},se=async()=>{o(!1),a(yt.optionlist),await m()},Y=()=>{o(!1)};return vt(()=>{h.value&&clearTimeout(h.value)}),(D,g)=>{const $=He,C=Ke;return k(),V(gt,{to:"body"},[c(C,{open:n(l),"onUpdate:open":g[1]||(g[1]=w=>pt(l)?l.value=w:null),title:n(i),centered:"",width:"480px","wrap-class-name":"upload-file-modal","destroy-on-close":""},{footer:O(()=>[b.dialogType===0?(k(),V($,{key:"submit",type:"primary",class:"upload-btn",disabled:!n(E),onClick:se},{default:O(()=>[X(x(n(t).confirm),1)]),_:1},8,["disabled"])):H("",!0),b.dialogType===1?(k(),V($,{key:"submit",type:"primary",class:"upload-btn",onClick:Y},{default:O(()=>[X(x(n(t).cancel),1)]),_:1})):H("",!0)]),default:O(()=>[p("div",fs,[p("div",ms,[p("div",vs,[p("input",{class:"hide input",type:"file",accept:L.join(","),multiple:"",onChange:N,onClick:g[0]||(g[0]=w=>w.target.value="")},null,40,hs),p("div",ys,[p("div",_s,[c(ht,{name:"upload"}),p("p",null,[p("span",bs,[X(x(n(t).dragUrl)+" ",1),p("span",ks,x(n(t).click),1)])])]),p("p",Cs,x(n(t).updesc1),1)])])])])]),_:1},8,["open","title"])])}}}),xs=fe(Ss,[["__scopeId","data-v-244df073"]]),Ct=e=>(ft("data-v-98037a09"),e=e(),mt(),e),As={class:"list-page"},$s={class:"content"},Is={class:"options"},Os=Ct(()=>p("img",{src:To,alt:"back"},null,-1)),Ps={class:"kb-name"},Ds={class:"name"},Fs={class:"id"},Ls={class:"nav-info"},Ns={class:"navs"},Rs=["onClick"],Ts={key:0,class:"nav-progress"},Es={class:"handle-btn"},Ms={class:"table"},zs=Ct(()=>p("img",{src:Eo,style:{width:"18px","margin-left":"5px"},alt:"©"},null,-1)),Ws={style:{color:"#666","user-select":"text"}},js={key:1,class:"status-box"},Us={class:"icon-file-status"},Bs={key:0},Vs={key:1},qs={key:0,class:"status-box"},Qs={class:"icon-file-status"},Xs={key:1,class:"options"},Zs=oe({__name:"OptionList",setup(e){const{setDefault:t}=Fe(),{currentKbName:s,currentId:o}=te(Fe()),{setModalVisible:a,setUrlModalVisible:m,setModalTitle:l}=Xe(),{showChunkModel:i}=te(kt()),{getDetails:d,setEditQaSet:P,setEditModalVisible:u,getFaqList:A,setFaqType:f,setPageNum:v,setKbPageNum:b}=De(),{dataSource:h,faqList:E,timer:L,faqTimer:R,total:T,pageNum:N,pageSize:Q,loading:W,kbTotal:se,kbPageNum:Y,kbPageSize:D}=te(De()),g=pe().home,$=pe().common,C=pe().bots,w=F(0),K=[{name:g.docSet,value:0},{name:g.qaSet,value:1}],ne=[{title:g.documentId,dataIndex:"fileId",key:"fileId",width:"11%"},{title:g.documentName,dataIndex:"fileIdName",key:"fileIdName",width:"20%",ellipsis:!0},{title:g.documentStatus,dataIndex:"status",key:"status",width:"15%",ellipsis:!0},{title:g.fileSize,dataIndex:"bytes",key:"bytes",width:"10%"},{title:g.contentLength,dataIndex:"contentLength",key:"contentLength",width:"10%"},{title:g.creationDate,dataIndex:"createtime",key:"createtime",width:"11%"},{title:g.remark,dataIndex:"remark",key:"remark",width:"15%"},{title:g.operate,key:"options",width:"10%"}],me=[{title:"ID",dataIndex:"id",key:"id",width:"8%"},{title:g.question,dataIndex:"question",key:"question",width:"43%",ellipsis:!0},{title:g.status,dataIndex:"status",key:"status",width:"10%",ellipsis:!0},{title:g.characterCount,dataIndex:"bytes",key:"bytes",width:"10%"},{title:g.creationDate,dataIndex:"createtime",key:"createtime",width:"11%"},{title:g.operate,key:"options",width:"10%"}],ve=I(()=>({current:Y.value,pageSize:D.value,total:se.value,showSizeChanger:!1,showTotal:_=>`共 ${_} 条`})),Me=I(()=>({current:N.value,pageSize:Q.value,total:T.value,showSizeChanger:!1,showTotal:_=>`共 ${_} 条`}));let he={};const ze=_=>{he=_},ye=F(""),_e=F(""),We=async _=>{ye.value=_.fileId,_e.value=_.fileIdName,i.value=!0},be=async()=>{try{await re(await ie.deleteFile({file_ids:[he.fileId],kb_id:o.value})),q.success("删除成功"),await d(),Y.value!==1&&h.value.length===0&&(Y.value-=1,await d())}catch(_){q.error(_.msg||"删除失败")}};let ke={};const Ce=_=>{ke=_},we=async()=>{try{await re(await ie.deleteFile({kb_id:`${o.value}_FAQ`,file_ids:[ke.faqId]})),q.success("删除成功"),await A(),N.value!==1&&E.value.length===0&&(N.value-=1,await A())}catch(_){q.error(_.msg||"删除失败")}},je=_=>{f("edit"),P(_),u(!0)},ue=()=>{t(yt.normal)},Se=()=>{a(!0),l(g.upload)},xe=()=>{m(!0),l($.addUrl)},Ae=()=>{f("upload"),u(!0)},Ue=()=>{Ke.confirm({title:g.clearAllFile,content:Qe("p",g.clearAllFileConfirm),centered:!0,maskClosable:!0,okText:$.confirm,okType:"danger",async onOk(){try{await re(await ie.clearUpload({status:"gray",kb_ids:[]})),q.success("操作成功"),d()}catch(_){q.error(_.msg||"操作失败")}}})},Be=_=>{let M;switch(_){case"gray":M=$.inLine;break;case"yellow":M=$.parsing;break;case"green":M=$.succeeded;break;default:M=$.failed;break}return M},$e=_=>{let M=$.failed;switch(_){case"gray":M=$.uploadCompleted;break;case"yellow":M=$.inLine;break;case"green":M=$.learningCompleted;break}return M},Ie=async()=>{try{if((await re(await ie.kbList())).find(M=>M.kb_id===`${o.value}_FAQ`))return!0}catch(_){return q.error(_.msg||$.error),!0}return!1},r=async()=>{if(!await Ie()){try{await re(await ie.createKb({kb_name:`${s.value}_FAQ`,kb_id:`${o.value}_FAQ`}))}catch(M){return q.error(M.msg||$.error),!1}return!0}},y=_=>{w.value=_,_===0?(b(1),clearTimeout(R.value),d()):(v(1),clearTimeout(L.value),A(),r())},S=_=>{const{current:M}=_;v(M),A()},j=_=>{b(_.current),d()};return Ne(o,()=>{w.value=0,b(1),v(1),d()},{immediate:!0}),vt(()=>{clearTimeout(L.value),clearTimeout(R.value),b(1),v(1)}),(_,M)=>{const J=He,Oe=Re,Pe=ht,ee=eo,Z=bt;return k(),B(le,null,[p("div",As,[p("div",$s,[p("div",Is,[p("div",{class:"to-chat",onClick:ue},[Os,p("span",null,x(n(g).conversation),1)]),p("p",Ps,[p("span",Ds,x(n(s)),1),p("span",Fs,x(n(g).knowledgeID)+" "+x(n(o))+x(n(w)===1?"_FAQ":""),1)])]),p("div",Ls,[p("div",Ns,[(k(),B(le,null,tt(K,U=>p("div",{key:U.name,class:Bt(["nav-item",n(w)===U.value?"nav-item-active":""]),onClick:z=>y(U.value)},x(U.name),11,Rs)),64))]),n(w)===0?(k(),B("div",Ts,[c(Ko,{"data-source":n(h)},null,8,["data-source"])])):H("",!0),p("div",Es,[n(w)===0?(k(),V(J,{key:0,danger:"",class:"clear-upload",onClick:Ue},{default:O(()=>[X(x(n(g).clearAllFile),1)]),_:1})):H("",!0),n(w)===0?(k(),V(J,{key:1,class:"upload",onClick:Se},{default:O(()=>[X(x(n(g).upload),1)]),_:1})):H("",!0),n(w)===0?(k(),V(J,{key:2,class:"add-link",onClick:xe},{default:O(()=>[X(x(n(g).addUrl),1)]),_:1})):H("",!0),n(w)===1?(k(),V(J,{key:3,class:"upload",onClick:Ae},{default:O(()=>[X(x(n(g).inputQa),1)]),_:1})):H("",!0)])]),p("div",Ms,[n(w)===0?(k(),V(Z,{key:0,"data-source":n(h),columns:ne,pagination:n(ve),locale:{emptyText:n(g).emptyText},"hide-on-single-page":!0,"show-size-changer":!1,onChange:j},{headerCell:O(({column:U})=>[U.key==="status"?(k(),B(le,{key:0},[p("span",null,x(n(g).documentStatus),1),c(Oe,{color:"#5a47e5"},{title:O(()=>[X(x(n(g).documentStatusNode),1)]),default:O(()=>[zs]),_:1})],64)):H("",!0)]),bodyCell:O(({column:U,record:z})=>[U.key==="fileIdName"?(k(),V(Oe,{key:0,color:"#fff"},{title:O(()=>[p("span",Ws,x(z.fileIdName),1)]),default:O(()=>[p("span",null,x(z.fileIdName),1)]),_:2},1024)):U.key==="status"?(k(),B("div",js,[p("span",Us,[z.status==="gray"||z.status==="yellow"?(k(),V(ct,{key:0,class:"file-status"})):(k(),V(Pe,{key:1,class:"file-status",name:z.status==="green"?"success":"error"},null,8,["name"]))]),p("span",null,x(Be(z.status)),1)])):U.key==="remark"?(k(),B(le,{key:2},[typeof z.remark=="string"?(k(),B("div",Bs,x(z.remark),1)):(k(),B("div",Vs,[(k(!0),B(le,null,tt(z.remark,(ge,et)=>(k(),B("p",{key:et},x(`${et}: ${ge}`),1))),128))]))],64)):U.key==="options"?(k(),B(le,{key:3},[c(ee,{"overlay-class-name":"del-pop",placement:"topRight",title:n($).deleteTitle,"ok-text":n($).confirm,"cancel-text":n($).cancel,onConfirm:be},{default:O(()=>[c(J,{type:"text",class:"delete-item",onClick:ge=>ze(z)},{default:O(()=>[X(x(n($).delete),1)]),_:2},1032,["onClick"])]),_:2},1032,["title","ok-text","cancel-text"]),c(J,{type:"text",class:"view-item",disabled:z.status!=="green",onClick:ge=>We(z)},{default:O(()=>[X(x(n($).view),1)]),_:2},1032,["disabled","onClick"])],64)):H("",!0)]),_:1},8,["data-source","pagination","locale"])):(k(),V(Z,{key:1,"data-source":n(E),columns:me,locale:{emptyText:n(g).emptyText},loading:n(W),pagination:n(Me),onChange:S},{bodyCell:O(({column:U,record:z})=>[U.key==="status"?(k(),B("div",qs,[p("span",Qs,[z.status==="gray"||z.status==="yellow"?(k(),V(ct,{key:0,class:"file-status"})):(k(),V(Pe,{key:1,class:"file-status",name:z.status==="green"?"success":"error"},null,8,["name"]))]),p("span",null,x($e(z.status)),1)])):U.key==="options"?(k(),B("div",Xs,[c(J,{class:"edit-item",type:"link",disabled:z.status!=="green",onClick:ge=>je(z)},{default:O(()=>[X(x(n(C).edit),1)]),_:2},1032,["disabled","onClick"]),c(ee,{"overlay-class-name":"qa-del-pop",placement:"topRight",title:n(g).deleteQaSetText,"ok-text":n($).confirm,"cancel-text":n($).cancel,onConfirm:we},{default:O(()=>[c(J,{class:"delete-item",danger:"",type:"link",onClick:ge=>Ce(z)},{default:O(()=>[X(x(n($).delete),1)]),_:2},1032,["onClick"])]),_:2},1032,["title","ok-text","cancel-text"])])):H("",!0)]),_:1},8,["data-source","locale","loading","pagination"]))])])]),c(gs,{"kb-id":n(o),"file-id":n(ye),"file-name":n(_e)},null,8,["kb-id","file-id","file-name"]),c(xs,{"dialog-type":0})],64)}}}),dn=fe(Zs,[["__scopeId","data-v-98037a09"]]);export{xs as F,ct as L,dn as O,un as _,Do as a};
